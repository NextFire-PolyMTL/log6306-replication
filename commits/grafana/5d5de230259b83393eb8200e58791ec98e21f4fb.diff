commit 5d5de230259b83393eb8200e58791ec98e21f4fb (from e4a2bda4f2b271154e096e6c17448eb17f65cad5)
Merge: e4a2bda4f2b d48be3ca151
Author: Torkel Ödegaard <torkel@grafana.com>
Date:   Wed Jan 10 11:54:47 2018 +0100

    refactoring: alert list improvments PR #10452

diff --git a/package.json b/package.json
index cc2bc19f95b..2f79acc41df 100644
--- a/package.json
+++ b/package.json
@@ -150,6 +150,7 @@
     "react-dom": "^16.2.0",
     "react-grid-layout": "^0.16.1",
     "react-popper": "^0.7.5",
+    "react-highlight-words": "^0.10.0",
     "react-sizeme": "^2.3.6",
     "remarkable": "^1.7.1",
     "rxjs": "^5.4.3",
diff --git a/public/app/containers/AlertRuleList/AlertRuleList.jest.tsx b/public/app/containers/AlertRuleList/AlertRuleList.jest.tsx
index 1025a7991f6..a12340555e9 100644
--- a/public/app/containers/AlertRuleList/AlertRuleList.jest.tsx
+++ b/public/app/containers/AlertRuleList/AlertRuleList.jest.tsx
@@ -45,7 +45,7 @@ describe('AlertRuleList', () => {
 
   it('should render 1 rule', () => {
     page.update();
-    let ruleNode = page.find('.card-item-wrapper');
+    let ruleNode = page.find('.alert-rule-item');
     expect(toJson(ruleNode)).toMatchSnapshot();
   });
 
diff --git a/public/app/containers/AlertRuleList/AlertRuleList.tsx b/public/app/containers/AlertRuleList/AlertRuleList.tsx
index 02eaa847a2c..36426c77943 100644
--- a/public/app/containers/AlertRuleList/AlertRuleList.tsx
+++ b/public/app/containers/AlertRuleList/AlertRuleList.tsx
@@ -5,6 +5,7 @@ import PageHeader from 'app/core/components/PageHeader/PageHeader';
 import { IAlertRule } from 'app/stores/AlertListStore/AlertListStore';
 import appEvents from 'app/core/app_events';
 import IContainerProps from 'app/containers/IContainerProps';
+import Highlighter from 'react-highlight-words';
 
 @inject('view', 'nav', 'alertList')
 @observer
@@ -23,11 +24,6 @@ export class AlertRuleList extends React.Component<IContainerProps, any> {
 
     this.props.nav.load('alerting', 'alert-list');
     this.fetchRules();
-    this.handleTooltipPositionChange = this.handleTooltipPositionChange.bind(this);
-
-    this.state = {
-      tooltipPosition: 'auto',
-    };
   }
 
   onStateFilterChanged = evt => {
@@ -49,12 +45,10 @@ export class AlertRuleList extends React.Component<IContainerProps, any> {
     });
   };
 
-  handleTooltipPositionChange(evt) {
-    evt.preventDefault();
-    this.setState({
-      tooltipPosition: evt.target.value,
-    });
-  }
+  onSearchQueryChange = evt => {
+    this.props.alertList.setSearchQuery(evt.target.value);
+  };
+
   render() {
     const { nav, alertList } = this.props;
 
@@ -63,8 +57,20 @@ export class AlertRuleList extends React.Component<IContainerProps, any> {
         <PageHeader model={nav as any} />
         <div className="page-container page-body">
           <div className="page-action-bar">
+            <div className="gf-form gf-form--grow">
+              <label className="gf-form--has-input-icon gf-form--grow">
+                <input
+                  type="text"
+                  className="gf-form-input"
+                  placeholder="Search alert"
+                  value={alertList.search}
+                  onChange={this.onSearchQueryChange}
+                />
+                <i className="gf-form-input-icon fa fa-search" />
+              </label>
+            </div>
             <div className="gf-form">
-              <label className="gf-form-label">Filter by state</label>
+              <label className="gf-form-label">States</label>
 
               <div className="gf-form-select-wrapper width-13">
                 <select className="gf-form-input" onChange={this.onStateFilterChanged} value={alertList.stateFilter}>
@@ -80,8 +86,12 @@ export class AlertRuleList extends React.Component<IContainerProps, any> {
             </a>
           </div>
 
-          <section className="card-section card-list-layout-list">
-            <ol className="card-list">{alertList.rules.map(rule => <AlertRuleItem rule={rule} key={rule.id} />)}</ol>
+          <section>
+            <ol className="alert-rule-list">
+              {alertList.filteredRules.map(rule => (
+                <AlertRuleItem rule={rule} key={rule.id} search={alertList.search} />
+              ))}
+            </ol>
           </section>
         </div>
       </div>
@@ -99,6 +109,7 @@ function AlertStateFilterOption({ text, value }) {
 
 export interface AlertRuleItemProps {
   rule: IAlertRule;
+  search: string;
 }
 
 @observer
@@ -107,6 +118,16 @@ export class AlertRuleItem extends React.Component<AlertRuleItemProps, any> {
     this.props.rule.togglePaused();
   };
 
+  renderText(text: string) {
+    return (
+      <Highlighter
+        highlightClassName="highlight-search-match"
+        textToHighlight={text}
+        searchWords={[this.props.search]}
+      />
+    );
+  }
+
   render() {
     const { rule } = this.props;
 
@@ -119,36 +140,33 @@ export class AlertRuleItem extends React.Component<AlertRuleItemProps, any> {
     let ruleUrl = `dashboard/${rule.dashboardUri}?panelId=${rule.panelId}&fullscreen&edit&tab=alert`;
 
     return (
-      <li className="card-item-wrapper">
-        <div className="card-item card-item--alert">
-          <div className="card-item-header">
-            <div className="card-item-type">
-              <a
-                className="card-item-cog"
-                title="Pausing an alert rule prevents it from executing"
-                onClick={this.toggleState}
-              >
-                <i className={stateClass} />
-              </a>
-              <a className="card-item-cog" href={ruleUrl} title="Edit alert rule">
-                <i className="icon-gf icon-gf-settings" />
-              </a>
+      <li className="alert-rule-item">
+        <span className={`alert-rule-item__icon ${rule.stateClass}`}>
+          <i className={rule.stateIcon} />
+        </span>
+        <div className="alert-rule-item__body">
+          <div className="alert-rule-item__header">
+            <div className="alert-rule-item__name">
+              <a href={ruleUrl}>{this.renderText(rule.name)}</a>
             </div>
-          </div>
-          <div className="card-item-body">
-            <div className="card-item-details">
-              <div className="card-item-name">
-                <a href={ruleUrl}>{rule.name}</a>
-              </div>
-              <div className="card-item-sub-name">
-                <span className={`alert-list-item-state ${rule.stateClass}`}>
-                  <i className={rule.stateIcon} /> {rule.stateText}
-                </span>
-                <span> for {rule.stateAge}</span>
-              </div>
-              {rule.info && <div className="small muted">{rule.info}</div>}
+            <div className="alert-rule-item__text">
+              <span className={`${rule.stateClass}`}>{this.renderText(rule.stateText)}</span>
+              <span className="alert-rule-item__time"> for {rule.stateAge}</span>
             </div>
           </div>
+          {rule.info && <div className="small muted alert-rule-item__info">{this.renderText(rule.info)}</div>}
+        </div>
+        <div className="alert-rule-item__actions">
+          <a
+            className="btn btn-small btn-inverse alert-list__btn width-2"
+            title="Pausing an alert rule prevents it from executing"
+            onClick={this.toggleState}
+          >
+            <i className={stateClass} />
+          </a>
+          <a className="btn btn-small btn-inverse alert-list__btn width-2" href={ruleUrl} title="Edit alert rule">
+            <i className="icon-gf icon-gf-settings" />
+          </a>
         </div>
       </li>
     );
diff --git a/public/app/containers/AlertRuleList/__snapshots__/AlertRuleList.jest.tsx.snap b/public/app/containers/AlertRuleList/__snapshots__/AlertRuleList.jest.tsx.snap
index b15a8605b7a..571566503f8 100644
--- a/public/app/containers/AlertRuleList/__snapshots__/AlertRuleList.jest.tsx.snap
+++ b/public/app/containers/AlertRuleList/__snapshots__/AlertRuleList.jest.tsx.snap
@@ -2,71 +2,102 @@
 
 exports[`AlertRuleList should render 1 rule 1`] = `
 <li
-  className="card-item-wrapper"
+  className="alert-rule-item"
 >
+  <span
+    className="alert-rule-item__icon alert-state-ok"
+  >
+    <i
+      className="icon-gf icon-gf-online"
+    />
+  </span>
   <div
-    className="card-item card-item--alert"
+    className="alert-rule-item__body"
   >
     <div
-      className="card-item-header"
+      className="alert-rule-item__header"
     >
       <div
-        className="card-item-type"
+        className="alert-rule-item__name"
       >
         <a
-          className="card-item-cog"
-          onClick={[Function]}
-          title="Pausing an alert rule prevents it from executing"
-        >
-          <i
-            className="fa fa-pause"
-          />
-        </a>
-        <a
-          className="card-item-cog"
           href="dashboard/db/mygool?panelId=3&fullscreen&edit&tab=alert"
-          title="Edit alert rule"
         >
-          <i
-            className="icon-gf icon-gf-settings"
-          />
+          <Highlighter
+            highlightClassName="highlight-search-match"
+            searchWords={
+              Array [
+                "",
+              ]
+            }
+            textToHighlight="Panel Title alert"
+          >
+            <span>
+              <span
+                className=""
+                key="0"
+              >
+                Panel Title alert
+              </span>
+            </span>
+          </Highlighter>
         </a>
       </div>
-    </div>
-    <div
-      className="card-item-body"
-    >
       <div
-        className="card-item-details"
+        className="alert-rule-item__text"
       >
-        <div
-          className="card-item-name"
+        <span
+          className="alert-state-ok"
         >
-          <a
-            href="dashboard/db/mygool?panelId=3&fullscreen&edit&tab=alert"
+          <Highlighter
+            highlightClassName="highlight-search-match"
+            searchWords={
+              Array [
+                "",
+              ]
+            }
+            textToHighlight="OK"
           >
-            Panel Title alert
-          </a>
-        </div>
-        <div
-          className="card-item-sub-name"
+            <span>
+              <span
+                className=""
+                key="0"
+              >
+                OK
+              </span>
+            </span>
+          </Highlighter>
+        </span>
+        <span
+          className="alert-rule-item__time"
         >
-          <span
-            className="alert-list-item-state alert-state-ok"
-          >
-            <i
-              className="icon-gf icon-gf-online"
-            />
-             
-            OK
-          </span>
-          <span>
-             for 
-            5 minutes
-          </span>
-        </div>
+           for 
+          5 minutes
+        </span>
       </div>
     </div>
   </div>
+  <div
+    className="alert-rule-item__actions"
+  >
+    <a
+      className="btn btn-small btn-inverse alert-list__btn width-2"
+      onClick={[Function]}
+      title="Pausing an alert rule prevents it from executing"
+    >
+      <i
+        className="fa fa-pause"
+      />
+    </a>
+    <a
+      className="btn btn-small btn-inverse alert-list__btn width-2"
+      href="dashboard/db/mygool?panelId=3&fullscreen&edit&tab=alert"
+      title="Edit alert rule"
+    >
+      <i
+        className="icon-gf icon-gf-settings"
+      />
+    </a>
+  </div>
 </li>
 `;
diff --git a/public/app/features/alerting/alert_def.ts b/public/app/features/alerting/alert_def.ts
index d5421ef2b9a..d86461780ba 100644
--- a/public/app/features/alerting/alert_def.ts
+++ b/public/app/features/alerting/alert_def.ts
@@ -138,10 +138,6 @@ function getAlertAnnotationInfo(ah) {
     return 'Error: ' + ah.data.error;
   }
 
-  if (ah.data.noData || ah.data.no_data) {
-    return 'No Data';
-  }
-
   return '';
 }
 
diff --git a/public/app/features/alerting/partials/alert_tab.html b/public/app/features/alerting/partials/alert_tab.html
index 9b5a535c727..cb101672aa4 100644
--- a/public/app/features/alerting/partials/alert_tab.html
+++ b/public/app/features/alerting/partials/alert_tab.html
@@ -12,7 +12,7 @@
 			<li ng-class="{active: ctrl.subTabIndex === 2}">
 				<a ng-click="ctrl.changeTabIndex(2)">State history</a>
 			</li>
-      			<li>
+      <li>
 				<a ng-click="ctrl.delete()">Delete</a>
 			</li>
 		</ul>
@@ -143,36 +143,33 @@
 				<i>No state changes recorded</i>
 			</div>
 
-			<section class="card-section card-list-layout-list">
-				<ol class="card-list" >
-					<li class="card-item-wrapper" ng-repeat="ah in ctrl.alertHistory">
-						<div class="alert-list card-item card-item--alert">
-							<div class="alert-list-body">
-								<div class="alert-list-icon alert-list-item-state {{ah.stateModel.stateClass}}">
-									<i class="{{ah.stateModel.iconClass}}"></i>
-								</div>
-								<div class="alert-list-main alert-list-text">
-									<span class="alert-list-state {{ah.stateModel.stateClass}}">{{ah.stateModel.text}}</span>
-									<span class="alert-list-info">{{ah.info}}</span>
-								</div>
-							</div>
-							<div class="alert-list-footer alert-list-text">
-								<span>{{ah.time}}</span>
-								<span><!--Img Link--></span>
-							</div>
-						</div>
-					</li>
-				</ol>
-			</section>
-		</div>
-	</div>
+      <ol class="alert-rule-list" >
+        <li class="alert-rule-item" ng-repeat="al in ctrl.alertHistory">
+          <div class="alert-rule-item__icon {{al.stateModel.stateClass}}">
+            <i class="{{al.stateModel.iconClass}}"></i>
+          </div>
+          <div class="alert-rule-item__body">
+            <div class="alert-rule-item__header">
+              <div class="alert-rule-item__text">
+                <span class="{{al.stateModel.stateClass}}">{{al.stateModel.text}}</span>
+              </div>
+            </div>
+            <span class="alert-list-info">{{al.info}}</span>
+          </div>
+          <div class="alert-rule-item__time">
+            <span>{{al.time}}</span>
+          </div>
+        </li>
+      </ol>
+    </div>
+  </div>
 </div>
 
 <div class="gf-form-group" ng-if="!ctrl.alert">
-	<div class="gf-form-button-row">
-		<button class="btn btn-inverse" ng-click="ctrl.enable()">
-			<i class="icon-gf icon-gf-alert"></i>
-			Create Alert
-		</button>
-	</div>
+  <div class="gf-form-button-row">
+    <button class="btn btn-inverse" ng-click="ctrl.enable()">
+      <i class="icon-gf icon-gf-alert"></i>
+      Create Alert
+    </button>
+  </div>
 </div>
diff --git a/public/app/plugins/panel/alertlist/module.html b/public/app/plugins/panel/alertlist/module.html
index bb946817cbd..d25570ceed3 100644
--- a/public/app/plugins/panel/alertlist/module.html
+++ b/public/app/plugins/panel/alertlist/module.html
@@ -3,24 +3,22 @@
 		{{ctrl.noAlertsMessage}}
 	</div>
 
-  <section class="card-section card-list-layout-list" ng-if="ctrl.panel.show === 'current'">
-    <ol class="card-list">
-			<li class="card-item-wrapper" ng-repeat="alert in ctrl.currentAlerts">
-        <div class="alert-list card-item card-item--alert">
-          <div class="alert-list-body">
-            <div class="alert-list-icon alert-list-item-state {{alert.stateModel.stateClass}}">
-              <i class="{{alert.stateModel.iconClass}}"></i>
-            </div>
-            <div class="alert-list-main">
-              <p class="alert-list-title">
-                <a href="dashboard/{{alert.dashboardUri}}?panelId={{alert.panelId}}&fullscreen&edit&tab=alert">
-                  {{alert.name}}
-                </a>
-              </p>
-              <p class="alert-list-text">
-                <span class="alert-list-state {{alert.stateModel.stateClass}}">{{alert.stateModel.text}}</span>
-                for {{alert.newStateDateAgo}}
-              </p>
+  <section ng-if="ctrl.panel.show === 'current'">
+    <ol class="alert-rule-list">
+      <li class="alert-rule-item" ng-repeat="alert in ctrl.currentAlerts">
+        <div class="alert-rule-item__body">
+          <div class="alert-rule-item__icon  {{alert.stateModel.stateClass}}">
+            <i class="{{alert.stateModel.iconClass}}"></i>
+          </div>
+          <div class="alert-rule-item__header">
+            <p class="alert-rule-item__name">
+              <a href="dashboard/{{alert.dashboardUri}}?panelId={{alert.panelId}}&fullscreen&edit&tab=alert">
+                {{alert.name}}
+              </a>
+            </p>
+            <div class="alert-rule-item__text">
+              <span class="{{alert.stateModel.stateClass}}">{{alert.stateModel.text}}</span>
+              <span class="alert-rule-item__time">for {{alert.newStateDateAgo}}</span>
             </div>
           </div>
         </div>
@@ -28,30 +26,25 @@
     </ol>
   </section>
 
-  <section class="card-section card-list-layout-list" ng-if="ctrl.panel.show === 'changes'">
-		<ol class="card-list">
-			<li class="card-item-wrapper" ng-repeat="al in ctrl.alertHistory">
-				<div class="alert-list card-item card-item--alert">
-					<div class="alert-list-body">
-						<div class="alert-list-icon alert-list-item-state {{al.stateModel.stateClass}}">
-							<i class="{{al.stateModel.iconClass}}"></i>
-						</div>
-						<div class="alert-list-main">
-							<p class="alert-list-title">{{al.alertName}}</p>
-							<div class="alert-list-text">
-								<span class="alert-list-state {{al.stateModel.stateClass}}">{{al.stateModel.text}}</span>
-								<span class="alert-list-info alert-list-info-left">{{al.info}}</span>
-							</div>
-						</div>
-					</div>
-					<div class="alert-list-footer">
-						<span class="alert-list-text">{{al.time}}</span>
-						<span class="alert-list-text">
-							<!--Img Link-->
-						</span>
-					</div>
-				</div>
-			</li>
-		</ol>
-	</section>
+  <section ng-if="ctrl.panel.show === 'changes'">
+    <ol class="alert-rule-list">
+      <li class="alert-rule-item" ng-repeat="al in ctrl.alertHistory">
+        <div class="alert-rule-item__icon {{al.stateModel.stateClass}}">
+          <i class="{{al.stateModel.iconClass}}"></i>
+        </div>
+        <div class="alert-rule-item__body">
+          <div class="alert-rule-item__header">
+            <p class="alert-rule-item__name">{{al.alertName}}</p>
+            <div class="alert-rule-item__text">
+              <span class="{{al.stateModel.stateClass}}">{{al.stateModel.text}}</span>
+            </div>
+          </div>
+          <span class="alert-rule-item__info">{{al.info}}</span>
+        </div>
+        <div class="alert-rule-item__time">
+          <span>{{al.time}}</span>
+        </div>
+      </li>
+    </ol>
+  </section>
 </div>
diff --git a/public/app/stores/AlertListStore/AlertListStore.jest.ts b/public/app/stores/AlertListStore/AlertListStore.jest.ts
new file mode 100644
index 00000000000..28b32858a39
--- /dev/null
+++ b/public/app/stores/AlertListStore/AlertListStore.jest.ts
@@ -0,0 +1,65 @@
+import { AlertListStore } from './AlertListStore';
+import { backendSrv } from 'test/mocks/common';
+import moment from 'moment';
+
+function getRule(name, state, info) {
+  return {
+    id: 11,
+    dashboardId: 58,
+    panelId: 3,
+    name: name,
+    state: state,
+    newStateDate: moment()
+      .subtract(5, 'minutes')
+      .format(),
+    evalData: {},
+    executionError: '',
+    dashboardUri: 'db/mygool',
+    stateText: state,
+    stateIcon: 'fa',
+    stateClass: 'asd',
+    stateAge: '10m',
+    info: info,
+  };
+}
+
+describe('AlertListStore', () => {
+  let store;
+
+  beforeAll(() => {
+    store = AlertListStore.create(
+      {
+        rules: [
+          getRule('Europe', 'OK', 'backend-01'),
+          getRule('Google', 'ALERTING', 'backend-02'),
+          getRule('Amazon', 'PAUSED', 'backend-03'),
+          getRule('West-Europe', 'PAUSED', 'backend-03'),
+        ],
+        search: '',
+      },
+      {
+        backendSrv: backendSrv,
+      }
+    );
+  });
+
+  it('search should filter list on name', () => {
+    store.setSearchQuery('urope');
+    expect(store.filteredRules).toHaveLength(2);
+  });
+
+  it('search should filter list on state', () => {
+    store.setSearchQuery('ale');
+    expect(store.filteredRules).toHaveLength(1);
+  });
+
+  it('search should filter list on info', () => {
+    store.setSearchQuery('-0');
+    expect(store.filteredRules).toHaveLength(4);
+  });
+
+  it('search should be equal', () => {
+    store.setSearchQuery('alert');
+    expect(store.search).toBe('alert');
+  });
+});
diff --git a/public/app/stores/AlertListStore/AlertListStore.ts b/public/app/stores/AlertListStore/AlertListStore.ts
index 78799f6dfd8..05dd181f41e 100644
--- a/public/app/stores/AlertListStore/AlertListStore.ts
+++ b/public/app/stores/AlertListStore/AlertListStore.ts
@@ -9,7 +9,16 @@ export const AlertListStore = types
   .model('AlertListStore', {
     rules: types.array(AlertRule),
     stateFilter: types.optional(types.string, 'all'),
+    search: types.optional(types.string, ''),
   })
+  .views(self => ({
+    get filteredRules() {
+      let regex = new RegExp(self.search, 'i');
+      return self.rules.filter(alert => {
+        return regex.test(alert.name) || regex.test(alert.stateText) || regex.test(alert.info);
+      });
+    },
+  }))
   .actions(self => ({
     loadRules: flow(function* load(filters) {
       const backendSrv = getEnv(self).backendSrv;
@@ -31,4 +40,7 @@ export const AlertListStore = types
         self.rules.push(AlertRule.create(rule));
       }
     }),
+    setSearchQuery(query: string) {
+      self.search = query;
+    },
   }));
diff --git a/public/sass/base/_type.scss b/public/sass/base/_type.scss
index aeddbc5ffb7..b69f7a0b439 100644
--- a/public/sass/base/_type.scss
+++ b/public/sass/base/_type.scss
@@ -299,7 +299,7 @@ blockquote {
     line-height: $line-height-base;
     color: $gray-2;
     &:before {
-      content: "\2014 \00A0";
+      content: '\2014 \00A0';
     }
   }
 
@@ -316,10 +316,10 @@ blockquote {
     }
     small {
       &:before {
-        content: "";
+        content: '';
       }
       &:after {
-        content: "\00A0 \2014";
+        content: '\00A0 \2014';
       }
     }
   }
@@ -330,7 +330,7 @@ q:before,
 q:after,
 blockquote:before,
 blockquote:after {
-  content: "";
+  content: '';
 }
 
 // Addresses
@@ -409,3 +409,8 @@ a.external-link {
 .no-wrap {
   white-space: nowrap;
 }
+
+.highlight-search-match {
+  background: transparent;
+  color: $yellow;
+}
diff --git a/public/sass/components/_gf-form.scss b/public/sass/components/_gf-form.scss
index 46c68a692fa..599a3e32a21 100644
--- a/public/sass/components/_gf-form.scss
+++ b/public/sass/components/_gf-form.scss
@@ -33,6 +33,7 @@ $input-border: 1px solid $input-border-color;
 
 .gf-form--has-input-icon {
   position: relative;
+  margin-right: $gf-form-margin;
 
   .gf-form-input-icon {
     position: absolute;
diff --git a/public/sass/pages/_alerting.scss b/public/sass/pages/_alerting.scss
index b20c90cda1c..f44e26d5c20 100644
--- a/public/sass/pages/_alerting.scss
+++ b/public/sass/pages/_alerting.scss
@@ -28,69 +28,6 @@
   border: 0;
 }
 
-// Alert List
-.alert-list {
-  display: flex;
-  flex-direction: row;
-  justify-content: space-between;
-}
-
-.alert-list-icon {
-  font-weight: bold;
-  display: flex;
-  justify-content: center;
-  align-items: center;
-  .icon-gf,
-  .fa {
-    font-size: 200%;
-    position: relative;
-    top: 2px;
-  }
-}
-
-.alert-list-body {
-  display: flex;
-}
-
-.alert-list-main {
-  padding: 0 2rem;
-  display: flex;
-  flex-direction: column;
-  justify-content: center;
-}
-
-.alert-list-title {
-  font-size: $font-size-base;
-  margin: 0;
-  font-weight: 600;
-}
-
-.alert-list-state {
-  font-weight: bold;
-}
-
-.alert-list-text {
-  font-size: $font-size-sm;
-  margin: 0;
-  line-height: 1.5rem;
-  color: $text-color-weak;
-}
-
-.alert-list-info {
-  color: $text-color;
-}
-
-.alert-list-info-left {
-  padding-left: 2rem;
-}
-
-.alert-list-footer {
-  display: flex;
-  justify-content: space-between;
-  flex-direction: column;
-  align-items: flex-end;
-}
-
 .panel-has-alert {
   .panel-alert-icon:before {
     content: '\e611';
@@ -136,3 +73,94 @@
     opacity: 1;
   }
 }
+
+// Alert List
+// Alert List
+
+.alert-rule-list {
+  display: flex;
+  flex-direction: row;
+  flex-wrap: wrap;
+  justify-content: space-between;
+  list-style-type: none;
+}
+
+.alert-rule-item {
+  display: flex;
+  width: 100%;
+  height: 100%;
+  background: $card-background;
+  box-shadow: $card-shadow;
+  padding: 4px 8px;
+  border-radius: 4px;
+  margin-bottom: 4px;
+}
+
+.alert-rule-item__body {
+  display: flex;
+  flex-direction: column;
+  flex-grow: 1;
+  overflow: hidden;
+}
+
+.alert-rule-item__icon {
+  display: flex;
+  justify-content: center;
+  align-items: center;
+  width: 40px;
+  padding: 0 28px 0 16px;
+  .icon-gf,
+  .fa {
+    font-size: 200%;
+    position: relative;
+    top: 2px;
+  }
+}
+
+.alert-rule-item__header {
+  display: flex;
+  flex-direction: column;
+  justify-content: space-between;
+}
+
+.alert-rule-item__name {
+  font-size: $font-size-base;
+  margin: 0;
+  font-weight: $font-weight-semi-bold;
+}
+
+.alert-list__btn {
+  margin: 0 2px;
+  display: flex;
+  align-items: center;
+  justify-content: center;
+}
+
+.alert-rule-item__text {
+  font-weight: bold;
+  font-size: $font-size-sm;
+  margin: 0;
+}
+
+.alert-rule-item__time {
+  color: $text-color-weak;
+  font-weight: normal;
+  white-space: nowrap;
+}
+
+.alert-rule-item__info {
+  //color: $text-color;
+  font-weight: normal;
+  flex-grow: 2;
+  display: flex;
+  align-items: flex-end;
+}
+
+.alert-rule-item__actions {
+  display: flex;
+  align-items: center;
+}
+
+.alert-tesint {
+  display: flex;
+}
diff --git a/yarn.lock b/yarn.lock
index fd9c6e70831..aa477878e4d 100644
--- a/yarn.lock
+++ b/yarn.lock
@@ -4430,6 +4430,10 @@ header-case@^1.0.0:
     no-case "^2.2.0"
     upper-case "^1.1.3"
 
+highlight-words-core@^1.1.0:
+  version "1.1.2"
+  resolved "https://registry.yarnpkg.com/highlight-words-core/-/highlight-words-core-1.1.2.tgz#5c2717c4f6c6e7ea2462ab85b43ff8b24f58ec3e"
+
 hmac-drbg@^1.0.0:
   version "1.0.1"
   resolved "https://registry.yarnpkg.com/hmac-drbg/-/hmac-drbg-1.0.1.tgz#d2745701025a6c775a6c545793ed502fc0c649a1"
@@ -7921,7 +7925,7 @@ promzard@^0.3.0:
   dependencies:
     read "1"
 
-prop-types@15.x, prop-types@^15.5.10, prop-types@^15.6.0:
+prop-types@15.x, prop-types@^15.5.10, prop-types@^15.5.8, prop-types@^15.6.0:
   version "15.6.0"
   resolved "https://registry.yarnpkg.com/prop-types/-/prop-types-15.6.0.tgz#ceaf083022fc46b4a35f69e13ef75aed0d639856"
   dependencies:
@@ -8134,6 +8138,13 @@ react-popper@^0.7.5:
     popper.js "^1.12.5"
     prop-types "^15.5.10"
 
+react-highlight-words@^0.10.0:
+  version "0.10.0"
+  resolved "https://registry.yarnpkg.com/react-highlight-words/-/react-highlight-words-0.10.0.tgz#2e905c76c11635237f848ecad00600f1b6f6f4a8"
+  dependencies:
+    highlight-words-core "^1.1.0"
+    prop-types "^15.5.8"
+
 react-resizable@^1.7.5:
   version "1.7.5"
   resolved "https://registry.yarnpkg.com/react-resizable/-/react-resizable-1.7.5.tgz#83eb75bb3684da6989bbbf4f826e1470f0af902e"

commit 5d5de230259b83393eb8200e58791ec98e21f4fb (from d48be3ca151855fbf01502c3bd85a455a291b9f3)
Merge: e4a2bda4f2b d48be3ca151
Author: Torkel Ödegaard <torkel@grafana.com>
Date:   Wed Jan 10 11:54:47 2018 +0100

    refactoring: alert list improvments PR #10452

diff --git a/docker/blocks/apache_proxy/Dockerfile b/docker/blocks/apache_proxy/Dockerfile
new file mode 100644
index 00000000000..37c2a4e493b
--- /dev/null
+++ b/docker/blocks/apache_proxy/Dockerfile
@@ -0,0 +1,4 @@
+FROM jmferrer/apache2-reverse-proxy:latest
+
+COPY ports.conf /etc/apache2/sites-enabled
+COPY proxy.conf /etc/apache2/sites-enabled
\ No newline at end of file
diff --git a/docker/blocks/apache_proxy/docker-compose.yaml b/docker/blocks/apache_proxy/docker-compose.yaml
new file mode 100644
index 00000000000..2aec3d4bc4f
--- /dev/null
+++ b/docker/blocks/apache_proxy/docker-compose.yaml
@@ -0,0 +1,9 @@
+# This will proxy all requests for http://localhost:10081/grafana/ to
+# http://localhost:3000 (Grafana running locally)
+#
+# Please note that you'll need to change the root_url in the Grafana configuration:
+# root_url = %(protocol)s://%(domain)s:/grafana/
+
+  apacheproxy:
+    build: blocks/apache_proxy
+    network_mode: host
diff --git a/docker/blocks/apache_proxy/ports.conf b/docker/blocks/apache_proxy/ports.conf
new file mode 100644
index 00000000000..e7a5f9712af
--- /dev/null
+++ b/docker/blocks/apache_proxy/ports.conf
@@ -0,0 +1 @@
+Listen 10081
\ No newline at end of file
diff --git a/docker/blocks/apache_proxy/proxy.conf b/docker/blocks/apache_proxy/proxy.conf
new file mode 100644
index 00000000000..5eb35cbe8b9
--- /dev/null
+++ b/docker/blocks/apache_proxy/proxy.conf
@@ -0,0 +1,4 @@
+<VirtualHost *:10081>
+    ProxyPass /grafana/ http://localhost:3000/
+    ProxyPassReverse /grafana/ http://localhost:3000/
+</VirtualHost>
\ No newline at end of file
diff --git a/docker/blocks/nginx_proxy/Dockerfile b/docker/blocks/nginx_proxy/Dockerfile
new file mode 100644
index 00000000000..9ded20dfdda
--- /dev/null
+++ b/docker/blocks/nginx_proxy/Dockerfile
@@ -0,0 +1,3 @@
+FROM nginx:alpine
+
+COPY nginx.conf /etc/nginx/nginx.conf
\ No newline at end of file
diff --git a/docker/blocks/nginx_proxy/docker-compose.yaml b/docker/blocks/nginx_proxy/docker-compose.yaml
new file mode 100644
index 00000000000..7c3447ade5c
--- /dev/null
+++ b/docker/blocks/nginx_proxy/docker-compose.yaml
@@ -0,0 +1,9 @@
+# This will proxy all requests for http://localhost:10080/grafana/ to
+# http://localhost:3000 (Grafana running locally)
+#
+# Please note that you'll need to change the root_url in the Grafana configuration:
+# root_url = %(protocol)s://%(domain)s:/grafana/
+
+  nginxproxy:
+    build: blocks/nginx_proxy
+    network_mode: host
diff --git a/docker/blocks/nginx_proxy/nginx.conf b/docker/blocks/nginx_proxy/nginx.conf
new file mode 100644
index 00000000000..18e27b3fb01
--- /dev/null
+++ b/docker/blocks/nginx_proxy/nginx.conf
@@ -0,0 +1,19 @@
+events { worker_connections 1024; }
+
+http {
+  sendfile on;
+
+  proxy_redirect     off;
+  proxy_set_header   Host $host;
+  proxy_set_header   X-Real-IP $remote_addr;
+  proxy_set_header   X-Forwarded-For $proxy_add_x_forwarded_for;
+  proxy_set_header   X-Forwarded-Host $server_name;
+
+  server {
+    listen 10080;
+
+    location /grafana/ {
+      proxy_pass http://localhost:3000/;
+    }
+  }
+}
\ No newline at end of file
diff --git a/docs/sources/administration/provisioning.md b/docs/sources/administration/provisioning.md
index 3dd5c5fd1d3..850fa813ef9 100644
--- a/docs/sources/administration/provisioning.md
+++ b/docs/sources/administration/provisioning.md
@@ -138,6 +138,7 @@ Since all datasources dont have the same configuration settings we only have the
 | ----| ---- | ---- | --- |
 | tlsAuth | boolean | *All* |  Enable TLS authentication using client cert configured in secure json data |
 | tlsAuthWithCACert | boolean | *All* | Enable TLS authtication using CA cert |
+| tlsSkipVerify | boolean | *All* | Controls whether a client verifies the server's certificate chain and host name. |
 | graphiteVersion | string | Graphite |  Graphite version  |
 | timeInterval | string | Elastic, Influxdb & Prometheus | Lowest interval/step value that should be used for this data source |
 | esVersion | string | Elastic | Elasticsearch version | 
diff --git a/package.json b/package.json
index c792808c865..2f79acc41df 100644
--- a/package.json
+++ b/package.json
@@ -149,6 +149,7 @@
     "react": "^16.2.0",
     "react-dom": "^16.2.0",
     "react-grid-layout": "^0.16.1",
+    "react-popper": "^0.7.5",
     "react-highlight-words": "^0.10.0",
     "react-sizeme": "^2.3.6",
     "remarkable": "^1.7.1",
diff --git a/pkg/api/avatar/avatar.go b/pkg/api/avatar/avatar.go
index 6824e330f00..ce9da1e8790 100644
--- a/pkg/api/avatar/avatar.go
+++ b/pkg/api/avatar/avatar.go
@@ -157,11 +157,11 @@ func NewCacheServer() *CacheServer {
 func newNotFound() *Avatar {
 	avatar := &Avatar{notFound: true}
 
-	// load transparent png into buffer
-	path := filepath.Join(setting.StaticRootPath, "img", "transparent.png")
+	// load user_profile png into buffer
+	path := filepath.Join(setting.StaticRootPath, "img", "user_profile.png")
 
 	if data, err := ioutil.ReadFile(path); err != nil {
-		log.Error(3, "Failed to read transparent.png, %v", path)
+		log.Error(3, "Failed to read user_profile.png, %v", path)
 	} else {
 		avatar.data = bytes.NewBuffer(data)
 	}
diff --git a/pkg/plugins/frontend_plugin.go b/pkg/plugins/frontend_plugin.go
index 90c18d90044..04af4060169 100644
--- a/pkg/plugins/frontend_plugin.go
+++ b/pkg/plugins/frontend_plugin.go
@@ -40,7 +40,7 @@ func getPluginLogoUrl(pluginType, path, baseUrl string) string {
 }
 
 func (fp *FrontendPluginBase) setPathsBasedOnApp(app *AppPlugin) {
-	appSubPath := strings.Replace(strings.Replace(fp.PluginDir, app.PluginDir, "", 1), "\\", "/", 1)
+	appSubPath := strings.Replace(strings.Replace(fp.PluginDir, app.PluginDir, "", 1), "\\", "/", -1)
 	fp.IncludedInAppId = app.Id
 	fp.BaseUrl = app.BaseUrl
 
diff --git a/pkg/plugins/frontend_plugin_test.go b/pkg/plugins/frontend_plugin_test.go
index 304cd38deae..311f9fcc510 100644
--- a/pkg/plugins/frontend_plugin_test.go
+++ b/pkg/plugins/frontend_plugin_test.go
@@ -14,7 +14,7 @@ func TestFrontendPlugin(t *testing.T) {
 
 		fp := &FrontendPluginBase{
 			PluginBase: PluginBase{
-				PluginDir: "c:\\grafana\\public\\app\\plugins\\app\\testdata\\datasource",
+				PluginDir: "c:\\grafana\\public\\app\\plugins\\app\\testdata\\datasources\\datasource",
 				BaseUrl:   "fpbase",
 			},
 		}
@@ -29,6 +29,6 @@ func TestFrontendPlugin(t *testing.T) {
 		}
 		fp.setPathsBasedOnApp(app)
 
-		So(fp.Module, ShouldEqual, "app/plugins/app/testdata/datasource/module")
+		So(fp.Module, ShouldEqual, "app/plugins/app/testdata/datasources/datasource/module")
 	})
 }
diff --git a/public/app/app.ts b/public/app/app.ts
index 6caa178bc83..9ac76b8ec91 100644
--- a/public/app/app.ts
+++ b/public/app/app.ts
@@ -29,6 +29,8 @@ _.move = function(array, fromIndex, toIndex) {
 import { coreModule, registerAngularDirectives } from './core/core';
 import { setupAngularRoutes } from './routes/routes';
 
+declare var System: any;
+
 export class GrafanaApp {
   registerFunctions: any;
   ngModuleDependencies: any[];
diff --git a/public/app/containers/AlertRuleList/AlertRuleList.tsx b/public/app/containers/AlertRuleList/AlertRuleList.tsx
index 1b0c77acddc..36426c77943 100644
--- a/public/app/containers/AlertRuleList/AlertRuleList.tsx
+++ b/public/app/containers/AlertRuleList/AlertRuleList.tsx
@@ -24,7 +24,6 @@ export class AlertRuleList extends React.Component<IContainerProps, any> {
 
     this.props.nav.load('alerting', 'alert-list');
     this.fetchRules();
-    this.state = { search: '' };
   }
 
   onStateFilterChanged = evt => {
@@ -58,11 +57,11 @@ export class AlertRuleList extends React.Component<IContainerProps, any> {
         <PageHeader model={nav as any} />
         <div className="page-container page-body">
           <div className="page-action-bar">
-            <div className="gf-form">
-              <label className="gf-form--has-input-icon">
+            <div className="gf-form gf-form--grow">
+              <label className="gf-form--has-input-icon gf-form--grow">
                 <input
                   type="text"
-                  className="gf-form-input width-13"
+                  className="gf-form-input"
                   placeholder="Search alert"
                   value={alertList.search}
                   onChange={this.onSearchQueryChange}
@@ -71,7 +70,7 @@ export class AlertRuleList extends React.Component<IContainerProps, any> {
               </label>
             </div>
             <div className="gf-form">
-              <label className="gf-form-label">Filter by state</label>
+              <label className="gf-form-label">States</label>
 
               <div className="gf-form-select-wrapper width-13">
                 <select className="gf-form-input" onChange={this.onStateFilterChanged} value={alertList.stateFilter}>
@@ -120,7 +119,13 @@ export class AlertRuleItem extends React.Component<AlertRuleItemProps, any> {
   };
 
   renderText(text: string) {
-    return <Highlighter highlightClassName="textHighlight" textToHighlight={text} searchWords={[this.props.search]} />;
+    return (
+      <Highlighter
+        highlightClassName="highlight-search-match"
+        textToHighlight={text}
+        searchWords={[this.props.search]}
+      />
+    );
   }
 
   render() {
@@ -136,10 +141,10 @@ export class AlertRuleItem extends React.Component<AlertRuleItemProps, any> {
 
     return (
       <li className="alert-rule-item">
+        <span className={`alert-rule-item__icon ${rule.stateClass}`}>
+          <i className={rule.stateIcon} />
+        </span>
         <div className="alert-rule-item__body">
-          <span className={`alert-rule-item__icon ${rule.stateClass}`}>
-            <i className={rule.stateIcon} />
-          </span>
           <div className="alert-rule-item__header">
             <div className="alert-rule-item__name">
               <a href={ruleUrl}>{this.renderText(rule.name)}</a>
@@ -151,7 +156,7 @@ export class AlertRuleItem extends React.Component<AlertRuleItemProps, any> {
           </div>
           {rule.info && <div className="small muted alert-rule-item__info">{this.renderText(rule.info)}</div>}
         </div>
-        <div className="alert-rule-item__footer">
+        <div className="alert-rule-item__actions">
           <a
             className="btn btn-small btn-inverse alert-list__btn width-2"
             title="Pausing an alert rule prevents it from executing"
diff --git a/public/app/containers/AlertRuleList/__snapshots__/AlertRuleList.jest.tsx.snap b/public/app/containers/AlertRuleList/__snapshots__/AlertRuleList.jest.tsx.snap
index 6c06eb9b3e9..571566503f8 100644
--- a/public/app/containers/AlertRuleList/__snapshots__/AlertRuleList.jest.tsx.snap
+++ b/public/app/containers/AlertRuleList/__snapshots__/AlertRuleList.jest.tsx.snap
@@ -4,16 +4,16 @@ exports[`AlertRuleList should render 1 rule 1`] = `
 <li
   className="alert-rule-item"
 >
+  <span
+    className="alert-rule-item__icon alert-state-ok"
+  >
+    <i
+      className="icon-gf icon-gf-online"
+    />
+  </span>
   <div
     className="alert-rule-item__body"
   >
-    <span
-      className="alert-rule-item__icon alert-state-ok"
-    >
-      <i
-        className="icon-gf icon-gf-online"
-      />
-    </span>
     <div
       className="alert-rule-item__header"
     >
@@ -24,7 +24,7 @@ exports[`AlertRuleList should render 1 rule 1`] = `
           href="dashboard/db/mygool?panelId=3&fullscreen&edit&tab=alert"
         >
           <Highlighter
-            highlightClassName="textHighlight"
+            highlightClassName="highlight-search-match"
             searchWords={
               Array [
                 "",
@@ -50,7 +50,7 @@ exports[`AlertRuleList should render 1 rule 1`] = `
           className="alert-state-ok"
         >
           <Highlighter
-            highlightClassName="textHighlight"
+            highlightClassName="highlight-search-match"
             searchWords={
               Array [
                 "",
@@ -78,7 +78,7 @@ exports[`AlertRuleList should render 1 rule 1`] = `
     </div>
   </div>
   <div
-    className="alert-rule-item__footer"
+    className="alert-rule-item__actions"
   >
     <a
       className="btn btn-small btn-inverse alert-list__btn width-2"
diff --git a/public/app/core/components/Tooltip/Popover.jest.tsx b/public/app/core/components/Tooltip/Popover.jest.tsx
new file mode 100644
index 00000000000..3850521d5e2
--- /dev/null
+++ b/public/app/core/components/Tooltip/Popover.jest.tsx
@@ -0,0 +1,16 @@
+﻿import React from 'react';
+import renderer from 'react-test-renderer';
+import Popover from './Popover';
+
+describe('Popover', () => {
+  it('renders correctly', () => {
+    const tree = renderer
+      .create(
+        <Popover placement="auto" content="Popover text">
+          <button>Button with Popover</button>
+        </Popover>
+      )
+      .toJSON();
+    expect(tree).toMatchSnapshot();
+  });
+});
diff --git a/public/app/core/components/Tooltip/Popover.tsx b/public/app/core/components/Tooltip/Popover.tsx
new file mode 100644
index 00000000000..4dc25d34130
--- /dev/null
+++ b/public/app/core/components/Tooltip/Popover.tsx
@@ -0,0 +1,34 @@
+﻿import React from 'react';
+import withTooltip from './withTooltip';
+import { Target } from 'react-popper';
+
+interface IPopoverProps {
+  tooltipSetState: (prevState: object) => void;
+}
+
+class Popover extends React.Component<IPopoverProps, any> {
+  constructor(props) {
+    super(props);
+    this.toggleTooltip = this.toggleTooltip.bind(this);
+  }
+
+  toggleTooltip() {
+    const { tooltipSetState } = this.props;
+    tooltipSetState(prevState => {
+      return {
+        ...prevState,
+        show: !prevState.show,
+      };
+    });
+  }
+
+  render() {
+    return (
+      <Target className="popper__target" onClick={this.toggleTooltip}>
+        {this.props.children}
+      </Target>
+    );
+  }
+}
+
+export default withTooltip(Popover);
diff --git a/public/app/core/components/Tooltip/Tooltip.jest.tsx b/public/app/core/components/Tooltip/Tooltip.jest.tsx
new file mode 100644
index 00000000000..bc0512ecef7
--- /dev/null
+++ b/public/app/core/components/Tooltip/Tooltip.jest.tsx
@@ -0,0 +1,16 @@
+﻿import React from 'react';
+import renderer from 'react-test-renderer';
+import Tooltip from './Tooltip';
+
+describe('Tooltip', () => {
+  it('renders correctly', () => {
+    const tree = renderer
+      .create(
+        <Tooltip placement="auto" content="Tooltip text">
+          <a href="http://www.grafana.com">Link with tooltip</a>
+        </Tooltip>
+      )
+      .toJSON();
+    expect(tree).toMatchSnapshot();
+  });
+});
diff --git a/public/app/core/components/Tooltip/Tooltip.tsx b/public/app/core/components/Tooltip/Tooltip.tsx
new file mode 100644
index 00000000000..ae4093ea3f1
--- /dev/null
+++ b/public/app/core/components/Tooltip/Tooltip.tsx
@@ -0,0 +1,45 @@
+﻿import React from 'react';
+import withTooltip from './withTooltip';
+import { Target } from 'react-popper';
+
+interface ITooltipProps {
+  tooltipSetState: (prevState: object) => void;
+}
+
+class Tooltip extends React.Component<ITooltipProps, any> {
+  constructor(props) {
+    super(props);
+    this.showTooltip = this.showTooltip.bind(this);
+    this.hideTooltip = this.hideTooltip.bind(this);
+  }
+
+  showTooltip() {
+    const { tooltipSetState } = this.props;
+    tooltipSetState(prevState => {
+      return {
+        ...prevState,
+        show: true,
+      };
+    });
+  }
+
+  hideTooltip() {
+    const { tooltipSetState } = this.props;
+    tooltipSetState(prevState => {
+      return {
+        ...prevState,
+        show: false,
+      };
+    });
+  }
+
+  render() {
+    return (
+      <Target className="popper__target" onMouseOver={this.showTooltip} onMouseOut={this.hideTooltip}>
+        {this.props.children}
+      </Target>
+    );
+  }
+}
+
+export default withTooltip(Tooltip);
diff --git a/public/app/core/components/Tooltip/__snapshots__/Popover.jest.tsx.snap b/public/app/core/components/Tooltip/__snapshots__/Popover.jest.tsx.snap
new file mode 100644
index 00000000000..7496c681747
--- /dev/null
+++ b/public/app/core/components/Tooltip/__snapshots__/Popover.jest.tsx.snap
@@ -0,0 +1,16 @@
+// Jest Snapshot v1, https://goo.gl/fbAQLP
+
+exports[`Popover renders correctly 1`] = `
+<div
+  className="popper__manager"
+>
+  <div
+    className="popper__target"
+    onClick={[Function]}
+  >
+    <button>
+      Button with Popover
+    </button>
+  </div>
+</div>
+`;
diff --git a/public/app/core/components/Tooltip/__snapshots__/Tooltip.jest.tsx.snap b/public/app/core/components/Tooltip/__snapshots__/Tooltip.jest.tsx.snap
new file mode 100644
index 00000000000..3d3d7ea074b
--- /dev/null
+++ b/public/app/core/components/Tooltip/__snapshots__/Tooltip.jest.tsx.snap
@@ -0,0 +1,19 @@
+// Jest Snapshot v1, https://goo.gl/fbAQLP
+
+exports[`Tooltip renders correctly 1`] = `
+<div
+  className="popper__manager"
+>
+  <div
+    className="popper__target"
+    onMouseOut={[Function]}
+    onMouseOver={[Function]}
+  >
+    <a
+      href="http://www.grafana.com"
+    >
+      Link with tooltip
+    </a>
+  </div>
+</div>
+`;
diff --git a/public/app/core/components/Tooltip/withTooltip.tsx b/public/app/core/components/Tooltip/withTooltip.tsx
new file mode 100644
index 00000000000..4b9115fad19
--- /dev/null
+++ b/public/app/core/components/Tooltip/withTooltip.tsx
@@ -0,0 +1,57 @@
+﻿import React from 'react';
+import { Manager, Popper, Arrow } from 'react-popper';
+
+interface IwithTooltipProps {
+  placement?: string;
+  content: string | ((props: any) => JSX.Element);
+}
+
+export default function withTooltip(WrappedComponent) {
+  return class extends React.Component<IwithTooltipProps, any> {
+    constructor(props) {
+      super(props);
+
+      this.setState = this.setState.bind(this);
+      this.state = {
+        placement: this.props.placement || 'auto',
+        show: false,
+      };
+    }
+
+    componentWillReceiveProps(nextProps) {
+      if (nextProps.placement && nextProps.placement !== this.state.placement) {
+        this.setState(prevState => {
+          return {
+            ...prevState,
+            placement: nextProps.placement,
+          };
+        });
+      }
+    }
+
+    renderContent(content) {
+      if (typeof content === 'function') {
+        // If it's a function we assume it's a React component
+        const ReactComponent = content;
+        return <ReactComponent />;
+      }
+      return content;
+    }
+
+    render() {
+      const { content } = this.props;
+
+      return (
+        <Manager className="popper__manager">
+          <WrappedComponent {...this.props} tooltipSetState={this.setState} />
+          {this.state.show ? (
+            <Popper placement={this.state.placement} className="popper">
+              {this.renderContent(content)}
+              <Arrow className="popper__arrow" />
+            </Popper>
+          ) : null}
+        </Manager>
+      );
+    }
+  };
+}
diff --git a/public/app/core/components/gf_page.ts b/public/app/core/components/gf_page.ts
index 5df3bd89715..ad0770940ec 100644
--- a/public/app/core/components/gf_page.ts
+++ b/public/app/core/components/gf_page.ts
@@ -1,5 +1,3 @@
-///<reference path="../../headers/common.d.ts" />
-
 import coreModule from 'app/core/core_module';
 
 const template = `
diff --git a/public/app/core/components/grafana_app.ts b/public/app/core/components/grafana_app.ts
index eb51334f358..c00b7b2181b 100644
--- a/public/app/core/components/grafana_app.ts
+++ b/public/app/core/components/grafana_app.ts
@@ -7,6 +7,7 @@ import { profiler } from 'app/core/profiler';
 import appEvents from 'app/core/app_events';
 import Drop from 'tether-drop';
 import { createStore } from 'app/stores/store';
+import colors from 'app/core/utils/colors';
 
 export class GrafanaCtrl {
   /** @ngInject */
@@ -26,6 +27,8 @@ export class GrafanaCtrl {
       $scope.dashAlerts = alertSrv;
     };
 
+    $rootScope.colors = colors;
+
     $scope.initDashboard = function(dashboardData, viewScope) {
       $scope.appEvent('dashboard-fetch-end', dashboardData);
       $controller('DashboardCtrl', { $scope: viewScope }).init(dashboardData);
diff --git a/public/app/core/components/help/help.ts b/public/app/core/components/help/help.ts
index a594b95bb4d..0676b4dae99 100644
--- a/public/app/core/components/help/help.ts
+++ b/public/app/core/components/help/help.ts
@@ -1,5 +1,3 @@
-///<reference path="../../../headers/common.d.ts" />
-
 import coreModule from '../../core_module';
 import appEvents from 'app/core/app_events';
 
diff --git a/public/app/core/components/info_popover.ts b/public/app/core/components/info_popover.ts
index 2701c7b6983..59332a6f716 100644
--- a/public/app/core/components/info_popover.ts
+++ b/public/app/core/components/info_popover.ts
@@ -1,5 +1,3 @@
-///<reference path="../../headers/common.d.ts" />
-
 import _ from 'lodash';
 import coreModule from 'app/core/core_module';
 import Drop from 'tether-drop';
diff --git a/public/app/core/components/org_switcher.ts b/public/app/core/components/org_switcher.ts
index e2bd1be7928..d6efeb51779 100644
--- a/public/app/core/components/org_switcher.ts
+++ b/public/app/core/components/org_switcher.ts
@@ -1,5 +1,3 @@
-///<reference path="../../headers/common.d.ts" />
-
 import coreModule from 'app/core/core_module';
 import { contextSrv } from 'app/core/services/context_srv';
 
diff --git a/public/app/core/components/query_part/query_part.ts b/public/app/core/components/query_part/query_part.ts
index 033e2e450a2..93f28cbc04f 100644
--- a/public/app/core/components/query_part/query_part.ts
+++ b/public/app/core/components/query_part/query_part.ts
@@ -1,5 +1,3 @@
-///<reference path="../../../headers/common.d.ts" />
-
 import _ from 'lodash';
 
 export class QueryPartDef {
diff --git a/public/app/core/components/query_part/query_part_editor.ts b/public/app/core/components/query_part/query_part_editor.ts
index 400892fe5f8..138da186238 100644
--- a/public/app/core/components/query_part/query_part_editor.ts
+++ b/public/app/core/components/query_part/query_part_editor.ts
@@ -1,5 +1,3 @@
-///<reference path="../../../headers/common.d.ts" />
-
 import _ from 'lodash';
 import $ from 'jquery';
 import coreModule from 'app/core/core_module';
diff --git a/public/app/core/components/scroll/scroll.ts b/public/app/core/components/scroll/scroll.ts
index b625d917ca8..bf0bbfaec4b 100644
--- a/public/app/core/components/scroll/scroll.ts
+++ b/public/app/core/components/scroll/scroll.ts
@@ -1,5 +1,6 @@
 import PerfectScrollbar from 'perfect-scrollbar';
 import coreModule from 'app/core/core_module';
+import appEvents from 'app/core/app_events';
 
 export function geminiScrollbar() {
   return {
@@ -7,6 +8,19 @@ export function geminiScrollbar() {
     link: function(scope, elem, attrs) {
       let scrollbar = new PerfectScrollbar(elem[0]);
 
+      appEvents.on(
+        'smooth-scroll-top',
+        () => {
+          elem.animate(
+            {
+              scrollTop: 0,
+            },
+            500
+          );
+        },
+        scope
+      );
+
       scope.$on('$routeChangeSuccess', () => {
         elem[0].scrollTop = 0;
       });
diff --git a/public/app/core/components/switch.ts b/public/app/core/components/switch.ts
index 3203a42cd70..d2de09216cc 100644
--- a/public/app/core/components/switch.ts
+++ b/public/app/core/components/switch.ts
@@ -1,5 +1,3 @@
-///<reference path="../../headers/common.d.ts" />
-
 import coreModule from 'app/core/core_module';
 
 var template = `
diff --git a/public/app/core/controllers/reset_password_ctrl.ts b/public/app/core/controllers/reset_password_ctrl.ts
index 38bd51d2933..bc184838803 100644
--- a/public/app/core/controllers/reset_password_ctrl.ts
+++ b/public/app/core/controllers/reset_password_ctrl.ts
@@ -17,7 +17,7 @@ export class ResetPasswordCtrl {
       main: {
         icon: 'gicon gicon-branding',
         subTitle: 'Reset your Grafana password',
-        breadcrumbs: [{ title: 'Login', url: '/login' }, { title: 'Reset Password' }],
+        breadcrumbs: [{ title: 'Login', url: 'login' }, { title: 'Reset Password' }],
       },
     };
 
diff --git a/public/app/core/controllers/signup_ctrl.ts b/public/app/core/controllers/signup_ctrl.ts
index 3b4fd6a4a9e..dbaca216e30 100644
--- a/public/app/core/controllers/signup_ctrl.ts
+++ b/public/app/core/controllers/signup_ctrl.ts
@@ -1,5 +1,3 @@
-///<reference path="../../headers/common.d.ts" />
-
 import config from 'app/core/config';
 import coreModule from '../core_module';
 
@@ -24,7 +22,7 @@ export class SignUpCtrl {
       main: {
         icon: 'gicon gicon-branding',
         subTitle: 'Register your Grafana account',
-        breadcrumbs: [{ title: 'Login', url: '/login' }, { title: 'Sign Up' }],
+        breadcrumbs: [{ title: 'Login', url: 'login' }, { title: 'Sign Up' }],
       },
     };
 
diff --git a/public/app/core/directives/array_join.ts b/public/app/core/directives/array_join.ts
index 1bf1c6a9f53..f3416f43576 100644
--- a/public/app/core/directives/array_join.ts
+++ b/public/app/core/directives/array_join.ts
@@ -1,5 +1,3 @@
-///<reference path="../../headers/common.d.ts" />
-
 import _ from 'lodash';
 import coreModule from '../core_module';
 
diff --git a/public/app/core/directives/diff-view.ts b/public/app/core/directives/diff-view.ts
index 2770a09a00b..84cb597e543 100644
--- a/public/app/core/directives/diff-view.ts
+++ b/public/app/core/directives/diff-view.ts
@@ -1,5 +1,3 @@
-///<reference path="../../headers/common.d.ts" />
-
 import angular from 'angular';
 import coreModule from '../core_module';
 
diff --git a/public/app/core/directives/give_focus.ts b/public/app/core/directives/give_focus.ts
index 41767d55c0f..32e7205f84b 100644
--- a/public/app/core/directives/give_focus.ts
+++ b/public/app/core/directives/give_focus.ts
@@ -1,5 +1,3 @@
-///<reference path="../../headers/common.d.ts" />
-
 import coreModule from '../core_module';
 
 coreModule.directive('giveFocus', function() {
diff --git a/public/app/core/filters/filters.ts b/public/app/core/filters/filters.ts
index 1556e0a94f5..c6aea32d38d 100644
--- a/public/app/core/filters/filters.ts
+++ b/public/app/core/filters/filters.ts
@@ -1,5 +1,3 @@
-///<reference path="../../headers/common.d.ts" />
-
 import _ from 'lodash';
 import angular from 'angular';
 import moment from 'moment';
diff --git a/public/app/core/services/alert_srv.ts b/public/app/core/services/alert_srv.ts
index ea15077b960..35e8e39804f 100644
--- a/public/app/core/services/alert_srv.ts
+++ b/public/app/core/services/alert_srv.ts
@@ -1,5 +1,3 @@
-///<reference path="../../headers/common.d.ts" />
-
 import angular from 'angular';
 import _ from 'lodash';
 import coreModule from 'app/core/core_module';
diff --git a/public/app/core/services/backend_srv.ts b/public/app/core/services/backend_srv.ts
index 5d582116d8e..3204db0ce5d 100644
--- a/public/app/core/services/backend_srv.ts
+++ b/public/app/core/services/backend_srv.ts
@@ -1,5 +1,3 @@
-///<reference path="../../headers/common.d.ts" />
-
 import _ from 'lodash';
 import coreModule from 'app/core/core_module';
 import appEvents from 'app/core/app_events';
diff --git a/public/app/core/services/dynamic_directive_srv.ts b/public/app/core/services/dynamic_directive_srv.ts
index cfcc70516b6..086843b6f9a 100644
--- a/public/app/core/services/dynamic_directive_srv.ts
+++ b/public/app/core/services/dynamic_directive_srv.ts
@@ -1,5 +1,3 @@
-///<reference path="../../headers/common.d.ts" />
-
 import angular from 'angular';
 import coreModule from '../core_module';
 
diff --git a/public/app/core/services/popover_srv.ts b/public/app/core/services/popover_srv.ts
index 7c1708b15a7..113e1e5fae7 100644
--- a/public/app/core/services/popover_srv.ts
+++ b/public/app/core/services/popover_srv.ts
@@ -1,5 +1,3 @@
-///<reference path="../../headers/common.d.ts" />
-
 import _ from 'lodash';
 import coreModule from 'app/core/core_module';
 import Drop from 'tether-drop';
diff --git a/public/app/core/services/util_srv.ts b/public/app/core/services/util_srv.ts
index 2a7dbe3a684..52c934ee9ee 100644
--- a/public/app/core/services/util_srv.ts
+++ b/public/app/core/services/util_srv.ts
@@ -1,5 +1,3 @@
-///<reference path="../../headers/common.d.ts" />
-
 import coreModule from 'app/core/core_module';
 import appEvents from 'app/core/app_events';
 
diff --git a/public/app/core/utils/css_loader.ts b/public/app/core/utils/css_loader.ts
index 4ff03ec3c97..42f59a9c27c 100644
--- a/public/app/core/utils/css_loader.ts
+++ b/public/app/core/utils/css_loader.ts
@@ -1,5 +1,3 @@
-///<reference path="../../headers/common.d.ts" />
-
 var waitSeconds = 100;
 var head = document.getElementsByTagName('head')[0];
 
diff --git a/public/app/core/utils/datemath.ts b/public/app/core/utils/datemath.ts
index b892d49f2d8..340591e5d9c 100644
--- a/public/app/core/utils/datemath.ts
+++ b/public/app/core/utils/datemath.ts
@@ -1,5 +1,3 @@
-///<reference path="../../headers/common.d.ts" />
-
 import _ from 'lodash';
 import moment from 'moment';
 
diff --git a/public/app/core/utils/emitter.ts b/public/app/core/utils/emitter.ts
index 3ac19e57a6a..ae2489810a1 100644
--- a/public/app/core/utils/emitter.ts
+++ b/public/app/core/utils/emitter.ts
@@ -1,4 +1,4 @@
-import EventEmitter from 'eventemitter3';
+import { EventEmitter } from 'eventemitter3';
 
 export class Emitter {
   emitter: any;
diff --git a/public/app/core/utils/rangeutil.ts b/public/app/core/utils/rangeutil.ts
index d772d2b6c3e..95cfe42f0b8 100644
--- a/public/app/core/utils/rangeutil.ts
+++ b/public/app/core/utils/rangeutil.ts
@@ -1,5 +1,3 @@
-///<reference path="../../headers/common.d.ts" />
-
 import _ from 'lodash';
 import moment from 'moment';
 import * as dateMath from './datemath';
diff --git a/public/app/features/alerting/alert_def.ts b/public/app/features/alerting/alert_def.ts
index d5421ef2b9a..d86461780ba 100644
--- a/public/app/features/alerting/alert_def.ts
+++ b/public/app/features/alerting/alert_def.ts
@@ -138,10 +138,6 @@ function getAlertAnnotationInfo(ah) {
     return 'Error: ' + ah.data.error;
   }
 
-  if (ah.data.noData || ah.data.no_data) {
-    return 'No Data';
-  }
-
   return '';
 }
 
diff --git a/public/app/features/alerting/alert_tab_ctrl.ts b/public/app/features/alerting/alert_tab_ctrl.ts
index 9073647fe61..29498f5d92b 100644
--- a/public/app/features/alerting/alert_tab_ctrl.ts
+++ b/public/app/features/alerting/alert_tab_ctrl.ts
@@ -1,5 +1,3 @@
-///<reference path="../../headers/common.d.ts" />
-
 import _ from 'lodash';
 import { ThresholdMapper } from './threshold_mapper';
 import { QueryPart } from 'app/core/components/query_part/query_part';
diff --git a/public/app/features/alerting/notification_edit_ctrl.ts b/public/app/features/alerting/notification_edit_ctrl.ts
index e0ac8359506..5cada3035a4 100644
--- a/public/app/features/alerting/notification_edit_ctrl.ts
+++ b/public/app/features/alerting/notification_edit_ctrl.ts
@@ -1,5 +1,3 @@
-///<reference path="../../headers/common.d.ts" />
-
 import _ from 'lodash';
 import { appEvents, coreModule } from 'app/core/core';
 
diff --git a/public/app/features/alerting/notifications_list_ctrl.ts b/public/app/features/alerting/notifications_list_ctrl.ts
index c22f5d61b1a..1113ebd7ceb 100644
--- a/public/app/features/alerting/notifications_list_ctrl.ts
+++ b/public/app/features/alerting/notifications_list_ctrl.ts
@@ -1,5 +1,3 @@
-///<reference path="../../headers/common.d.ts" />
-
 import { coreModule } from 'app/core/core';
 
 export class AlertNotificationsListCtrl {
diff --git a/public/app/features/alerting/partials/alert_tab.html b/public/app/features/alerting/partials/alert_tab.html
index 9b5a535c727..cb101672aa4 100644
--- a/public/app/features/alerting/partials/alert_tab.html
+++ b/public/app/features/alerting/partials/alert_tab.html
@@ -12,7 +12,7 @@
 			<li ng-class="{active: ctrl.subTabIndex === 2}">
 				<a ng-click="ctrl.changeTabIndex(2)">State history</a>
 			</li>
-      			<li>
+      <li>
 				<a ng-click="ctrl.delete()">Delete</a>
 			</li>
 		</ul>
@@ -143,36 +143,33 @@
 				<i>No state changes recorded</i>
 			</div>
 
-			<section class="card-section card-list-layout-list">
-				<ol class="card-list" >
-					<li class="card-item-wrapper" ng-repeat="ah in ctrl.alertHistory">
-						<div class="alert-list card-item card-item--alert">
-							<div class="alert-list-body">
-								<div class="alert-list-icon alert-list-item-state {{ah.stateModel.stateClass}}">
-									<i class="{{ah.stateModel.iconClass}}"></i>
-								</div>
-								<div class="alert-list-main alert-list-text">
-									<span class="alert-list-state {{ah.stateModel.stateClass}}">{{ah.stateModel.text}}</span>
-									<span class="alert-list-info">{{ah.info}}</span>
-								</div>
-							</div>
-							<div class="alert-list-footer alert-list-text">
-								<span>{{ah.time}}</span>
-								<span><!--Img Link--></span>
-							</div>
-						</div>
-					</li>
-				</ol>
-			</section>
-		</div>
-	</div>
+      <ol class="alert-rule-list" >
+        <li class="alert-rule-item" ng-repeat="al in ctrl.alertHistory">
+          <div class="alert-rule-item__icon {{al.stateModel.stateClass}}">
+            <i class="{{al.stateModel.iconClass}}"></i>
+          </div>
+          <div class="alert-rule-item__body">
+            <div class="alert-rule-item__header">
+              <div class="alert-rule-item__text">
+                <span class="{{al.stateModel.stateClass}}">{{al.stateModel.text}}</span>
+              </div>
+            </div>
+            <span class="alert-list-info">{{al.info}}</span>
+          </div>
+          <div class="alert-rule-item__time">
+            <span>{{al.time}}</span>
+          </div>
+        </li>
+      </ol>
+    </div>
+  </div>
 </div>
 
 <div class="gf-form-group" ng-if="!ctrl.alert">
-	<div class="gf-form-button-row">
-		<button class="btn btn-inverse" ng-click="ctrl.enable()">
-			<i class="icon-gf icon-gf-alert"></i>
-			Create Alert
-		</button>
-	</div>
+  <div class="gf-form-button-row">
+    <button class="btn btn-inverse" ng-click="ctrl.enable()">
+      <i class="icon-gf icon-gf-alert"></i>
+      Create Alert
+    </button>
+  </div>
 </div>
diff --git a/public/app/features/dashboard/acl/acl.ts b/public/app/features/dashboard/acl/acl.ts
index f1f9b83dd5c..d65a41a28fe 100644
--- a/public/app/features/dashboard/acl/acl.ts
+++ b/public/app/features/dashboard/acl/acl.ts
@@ -1,5 +1,3 @@
-///<reference path="../../../headers/common.d.ts" />
-
 import coreModule from 'app/core/core_module';
 import _ from 'lodash';
 
diff --git a/public/app/features/dashboard/ad_hoc_filters.ts b/public/app/features/dashboard/ad_hoc_filters.ts
index 34f28b28b56..ee57db23675 100644
--- a/public/app/features/dashboard/ad_hoc_filters.ts
+++ b/public/app/features/dashboard/ad_hoc_filters.ts
@@ -1,5 +1,3 @@
-///<reference path="../../headers/common.d.ts" />
-
 import _ from 'lodash';
 import angular from 'angular';
 import coreModule from 'app/core/core_module';
diff --git a/public/app/features/dashboard/alerting_srv.ts b/public/app/features/dashboard/alerting_srv.ts
index 6d0148b1391..446c3218f79 100644
--- a/public/app/features/dashboard/alerting_srv.ts
+++ b/public/app/features/dashboard/alerting_srv.ts
@@ -1,5 +1,3 @@
-///<reference path="../../headers/common.d.ts" />
-
 import coreModule from 'app/core/core_module';
 
 export class AlertingSrv {
diff --git a/public/app/features/dashboard/dashgrid/AddPanelPanel.tsx b/public/app/features/dashboard/dashgrid/AddPanelPanel.tsx
index 1f143f3d7f7..01d16436a45 100644
--- a/public/app/features/dashboard/dashgrid/AddPanelPanel.tsx
+++ b/public/app/features/dashboard/dashgrid/AddPanelPanel.tsx
@@ -21,6 +21,8 @@ export interface AddPanelPanelState {
 export class AddPanelPanel extends React.Component<AddPanelPanelProps, AddPanelPanelState> {
   constructor(props) {
     super(props);
+    this.handleCloseAddPanel = this.handleCloseAddPanel.bind(this);
+    this.renderPanelItem = this.renderPanelItem.bind(this);
 
     this.state = {
       panelPlugins: this.getPanelPlugins(),
@@ -83,6 +85,13 @@ export class AddPanelPanel extends React.Component<AddPanelPanelProps, AddPanelP
     dashboard.removePanel(this.props.panel);
   };
 
+  handleCloseAddPanel(evt) {
+    evt.preventDefault();
+    const panelContainer = this.props.getPanelContainer();
+    const dashboard = panelContainer.getDashboard();
+    dashboard.removePanel(dashboard.panels[0]);
+  }
+
   renderPanelItem(panel, index) {
     console.log('render panel', index);
     return (
@@ -101,10 +110,11 @@ export class AddPanelPanel extends React.Component<AddPanelPanelProps, AddPanelP
             <i className="gicon gicon-add-panel" />
             <span className="add-panel__title">New Panel</span>
             <span className="add-panel__sub-title">Select a visualization</span>
+            <button className="add-panel__close" onClick={this.handleCloseAddPanel}>
+              <i className="fa fa-close" />
+            </button>
           </div>
-          <ScrollBar className="add-panel__items">
-            {this.state.panelPlugins.map(this.renderPanelItem.bind(this))}
-          </ScrollBar>
+          <ScrollBar className="add-panel__items">{this.state.panelPlugins.map(this.renderPanelItem)}</ScrollBar>
         </div>
       </div>
     );
diff --git a/public/app/features/dashboard/dashnav/dashnav.ts b/public/app/features/dashboard/dashnav/dashnav.ts
index 3c1ea397a52..2f1a2936419 100644
--- a/public/app/features/dashboard/dashnav/dashnav.ts
+++ b/public/app/features/dashboard/dashnav/dashnav.ts
@@ -73,9 +73,9 @@ export class DashNavCtrl {
   }
 
   addPanel() {
+    appEvents.emit('smooth-scroll-top');
     if (this.dashboard.panels.length > 0 && this.dashboard.panels[0].type === 'add-panel') {
-      this.dashboard.removePanel(this.dashboard.panels[0]);
-      return;
+      return; // Return if the "Add panel" exists already
     }
 
     this.dashboard.addPanel({
diff --git a/public/app/features/dashboard/folder_page_loader.ts b/public/app/features/dashboard/folder_page_loader.ts
old mode 100644
new mode 100755
index a2632df3d88..c2ec057ab8d
--- a/public/app/features/dashboard/folder_page_loader.ts
+++ b/public/app/features/dashboard/folder_page_loader.ts
@@ -11,28 +11,28 @@ export class FolderPageLoader {
         subTitle: 'Manage folder dashboards & permissions',
         url: '',
         text: '',
-        breadcrumbs: [{ title: 'Dashboards', url: '/dashboards' }, { title: ' ' }],
+        breadcrumbs: [{ title: 'Dashboards', url: 'dashboards' }, { title: ' ' }],
         children: [
           {
             active: activeChildId === 'manage-folder-dashboards',
             icon: 'fa fa-fw fa-th-large',
             id: 'manage-folder-dashboards',
             text: 'Dashboards',
-            url: '/dashboards',
+            url: 'dashboards',
           },
           {
             active: activeChildId === 'manage-folder-permissions',
             icon: 'fa fa-fw fa-lock',
             id: 'manage-folder-permissions',
             text: 'Permissions',
-            url: '/dashboards/permissions',
+            url: 'dashboards/permissions',
           },
           {
             active: activeChildId === 'manage-folder-settings',
             icon: 'fa fa-fw fa-cog',
             id: 'manage-folder-settings',
             text: 'Settings',
-            url: '/dashboards/settings',
+            url: 'dashboards/settings',
           },
         ],
       },
@@ -41,7 +41,7 @@ export class FolderPageLoader {
     return this.backendSrv.getDashboard('db', this.$routeParams.slug).then(result => {
       const folderTitle = result.dashboard.title;
       ctrl.navModel.main.text = '';
-      ctrl.navModel.main.breadcrumbs = [{ title: 'Dashboards', url: '/dashboards' }, { title: folderTitle }];
+      ctrl.navModel.main.breadcrumbs = [{ title: 'Dashboards', url: 'dashboards' }, { title: folderTitle }];
 
       const folderUrl = this.createFolderUrl(folderId, result.meta.type, result.meta.slug);
 
diff --git a/public/app/features/dashboard/save_modal.ts b/public/app/features/dashboard/save_modal.ts
index 5b1730c0135..33165758555 100644
--- a/public/app/features/dashboard/save_modal.ts
+++ b/public/app/features/dashboard/save_modal.ts
@@ -1,5 +1,3 @@
-///<reference path="../../headers/common.d.ts" />
-
 import coreModule from 'app/core/core_module';
 
 const template = `
diff --git a/public/app/features/dashboard/settings/settings.ts b/public/app/features/dashboard/settings/settings.ts
old mode 100644
new mode 100755
index e68b771bcb2..2ac718f9f22
--- a/public/app/features/dashboard/settings/settings.ts
+++ b/public/app/features/dashboard/settings/settings.ts
@@ -2,6 +2,7 @@ import { coreModule, appEvents, contextSrv } from 'app/core/core';
 import { DashboardModel } from '../dashboard_model';
 import $ from 'jquery';
 import _ from 'lodash';
+import config from 'app/core/config';
 
 export class SettingsCtrl {
   dashboard: DashboardModel;
@@ -86,7 +87,7 @@ export class SettingsCtrl {
 
     for (let section of this.sections) {
       const sectionParams = _.defaults({ editview: section.id }, params);
-      section.url = url + '?' + $.param(sectionParams);
+      section.url = config.appSubUrl + url + '?' + $.param(sectionParams);
     }
   }
 
diff --git a/public/app/features/dashboard/submenu/submenu.ts b/public/app/features/dashboard/submenu/submenu.ts
index 0d4f2462bda..ecf9616cf75 100644
--- a/public/app/features/dashboard/submenu/submenu.ts
+++ b/public/app/features/dashboard/submenu/submenu.ts
@@ -1,5 +1,3 @@
-///<reference path="../../../headers/common.d.ts" />
-
 import angular from 'angular';
 import _ from 'lodash';
 
diff --git a/public/app/features/dashboard/time_srv.ts b/public/app/features/dashboard/time_srv.ts
index e8339a06769..3f7b5836653 100644
--- a/public/app/features/dashboard/time_srv.ts
+++ b/public/app/features/dashboard/time_srv.ts
@@ -1,5 +1,3 @@
-///<reference path="../../headers/common.d.ts" />
-
 import moment from 'moment';
 import _ from 'lodash';
 import coreModule from 'app/core/core_module';
diff --git a/public/app/features/dashboard/unsaved_changes_modal.ts b/public/app/features/dashboard/unsaved_changes_modal.ts
index fa327e036c1..cb83a1baa0c 100644
--- a/public/app/features/dashboard/unsaved_changes_modal.ts
+++ b/public/app/features/dashboard/unsaved_changes_modal.ts
@@ -1,5 +1,3 @@
-///<reference path="../../headers/common.d.ts" />
-
 import coreModule from 'app/core/core_module';
 
 const template = `
diff --git a/public/app/features/dashboard/unsaved_changes_srv.ts b/public/app/features/dashboard/unsaved_changes_srv.ts
index adf808b9bf0..12eebb1077f 100644
--- a/public/app/features/dashboard/unsaved_changes_srv.ts
+++ b/public/app/features/dashboard/unsaved_changes_srv.ts
@@ -35,12 +35,12 @@ export class Tracker {
 
     $window.onbeforeunload = () => {
       if (this.ignoreChanges()) {
-        return '';
+        return null;
       }
       if (this.hasChanges()) {
         return 'There are unsaved changes to this dashboard';
       }
-      return '';
+      return null;
     };
 
     scope.$on('$locationChangeStart', (event, next) => {
diff --git a/public/app/features/dashboard/upload.ts b/public/app/features/dashboard/upload.ts
index 563ddfd490a..63941c89379 100644
--- a/public/app/features/dashboard/upload.ts
+++ b/public/app/features/dashboard/upload.ts
@@ -1,5 +1,3 @@
-///<reference path="../../headers/common.d.ts" />
-
 import coreModule from 'app/core/core_module';
 
 var template = `
diff --git a/public/app/features/dashlinks/module.ts b/public/app/features/dashlinks/module.ts
index 033dc97a364..8fa110fe6b4 100644
--- a/public/app/features/dashlinks/module.ts
+++ b/public/app/features/dashlinks/module.ts
@@ -30,7 +30,9 @@ function dashLink($compile, linkSrv) {
       if (link.asDropdown) {
         template +=
           '<ul class="dropdown-menu" role="menu">' +
-          '<li ng-repeat="dash in link.searchHits"><a href="{{dash.url}}">{{dash.title}}</a></li>' +
+          '<li ng-repeat="dash in link.searchHits">' +
+          '<a href="{{dash.url}}" target="{{dash.target}}">{{dash.title}}</a>' +
+          '</li>' +
           '</ul>';
       }
 
@@ -84,6 +86,7 @@ export class DashLinksContainerCtrl {
               tags: linkDef.tags,
               keepTime: linkDef.keepTime,
               includeVars: linkDef.includeVars,
+              target: linkDef.targetBlank ? '_blank' : '_self',
               icon: 'fa fa-bars',
               asDropdown: true,
             },
@@ -128,6 +131,7 @@ export class DashLinksContainerCtrl {
               memo.push({
                 title: dash.title,
                 url: 'dashboard/' + dash.uri,
+                target: link.target,
                 icon: 'fa fa-th-large',
                 keepTime: link.keepTime,
                 includeVars: link.includeVars,
diff --git a/public/app/features/org/partials/teams.html b/public/app/features/org/partials/teams.html
old mode 100644
new mode 100755
index f5c000dab25..e15a15cf573
--- a/public/app/features/org/partials/teams.html
+++ b/public/app/features/org/partials/teams.html
@@ -8,7 +8,7 @@
     </label>
     <div class="page-action-bar__spacer"></div>
 
-    <a class="btn btn-success" href="/org/teams/new">
+    <a class="btn btn-success" href="org/teams/new">
       <i class="fa fa-plus"></i>
 			Add Team
     </a>
diff --git a/public/app/features/org/prefs_control.ts b/public/app/features/org/prefs_control.ts
index c21d495a004..76428b74a8f 100644
--- a/public/app/features/org/prefs_control.ts
+++ b/public/app/features/org/prefs_control.ts
@@ -1,5 +1,3 @@
-///<reference path="../../headers/common.d.ts" />
-
 import config from 'app/core/config';
 import coreModule from 'app/core/core_module';
 
diff --git a/public/app/features/org/teams_ctrl.ts b/public/app/features/org/teams_ctrl.ts
index ea7c706a46f..29317e73d3b 100644
--- a/public/app/features/org/teams_ctrl.ts
+++ b/public/app/features/org/teams_ctrl.ts
@@ -1,5 +1,3 @@
-///<reference path="../../headers/common.d.ts" />
-
 import coreModule from 'app/core/core_module';
 import appEvents from 'app/core/app_events';
 
diff --git a/public/app/features/panel/panel_editor_tab.ts b/public/app/features/panel/panel_editor_tab.ts
index fb74abaf1f4..89eaba88299 100644
--- a/public/app/features/panel/panel_editor_tab.ts
+++ b/public/app/features/panel/panel_editor_tab.ts
@@ -1,5 +1,3 @@
-///<reference path="../../headers/common.d.ts" />
-
 import angular from 'angular';
 
 var directiveModule = angular.module('grafana.directives');
diff --git a/public/app/features/panel/panel_header.ts b/public/app/features/panel/panel_header.ts
index ca6ed68b648..f65be321207 100644
--- a/public/app/features/panel/panel_header.ts
+++ b/public/app/features/panel/panel_header.ts
@@ -1,5 +1,3 @@
-///<reference path="../../headers/common.d.ts" />
-
 import $ from 'jquery';
 import { coreModule } from 'app/core/core';
 
diff --git a/public/app/features/panel/query_ctrl.ts b/public/app/features/panel/query_ctrl.ts
index 4b9d8e0d07a..371d2852659 100644
--- a/public/app/features/panel/query_ctrl.ts
+++ b/public/app/features/panel/query_ctrl.ts
@@ -1,5 +1,3 @@
-///<reference path="../../headers/common.d.ts" />
-
 import _ from 'lodash';
 
 export class QueryCtrl {
diff --git a/public/app/features/panel/query_editor_row.ts b/public/app/features/panel/query_editor_row.ts
index bfc2de2451b..00220f83aa7 100644
--- a/public/app/features/panel/query_editor_row.ts
+++ b/public/app/features/panel/query_editor_row.ts
@@ -1,5 +1,3 @@
-///<reference path="../../headers/common.d.ts" />
-
 import angular from 'angular';
 
 var module = angular.module('grafana.directives');
diff --git a/public/app/features/panel/query_troubleshooter.ts b/public/app/features/panel/query_troubleshooter.ts
index 2db730560fd..537bfa79cdd 100644
--- a/public/app/features/panel/query_troubleshooter.ts
+++ b/public/app/features/panel/query_troubleshooter.ts
@@ -1,5 +1,3 @@
-///<reference path="../../headers/common.d.ts" />
-
 import _ from 'lodash';
 import appEvents from 'app/core/app_events';
 import { coreModule, JsonExplorer } from 'app/core/core';
diff --git a/public/app/features/playlist/playlist_search.ts b/public/app/features/playlist/playlist_search.ts
index 898dfbd2937..3b80cfdf640 100644
--- a/public/app/features/playlist/playlist_search.ts
+++ b/public/app/features/playlist/playlist_search.ts
@@ -1,5 +1,3 @@
-///<reference path="../../headers/common.d.ts" />
-
 import coreModule from '../../core/core_module';
 
 export class PlaylistSearchCtrl {
diff --git a/public/app/features/playlist/playlist_srv.ts b/public/app/features/playlist/playlist_srv.ts
index 8e61fdf1f15..9b5d67a4f6f 100644
--- a/public/app/features/playlist/playlist_srv.ts
+++ b/public/app/features/playlist/playlist_srv.ts
@@ -1,5 +1,3 @@
-///<reference path="../../headers/common.d.ts" />
-
 import coreModule from '../../core/core_module';
 import kbn from 'app/core/utils/kbn';
 import appEvents from 'app/core/app_events';
diff --git a/public/app/features/playlist/playlists_ctrl.ts b/public/app/features/playlist/playlists_ctrl.ts
index c18f8e7ee46..bc7e2bb1440 100644
--- a/public/app/features/playlist/playlists_ctrl.ts
+++ b/public/app/features/playlist/playlists_ctrl.ts
@@ -1,5 +1,3 @@
-///<reference path="../../headers/common.d.ts" />
-
 import _ from 'lodash';
 import coreModule from '../../core/core_module';
 
diff --git a/public/app/features/plugins/import_list/import_list.ts b/public/app/features/plugins/import_list/import_list.ts
index 92fc89e0996..f3c1168124d 100644
--- a/public/app/features/plugins/import_list/import_list.ts
+++ b/public/app/features/plugins/import_list/import_list.ts
@@ -1,5 +1,3 @@
-///<reference path="../../../headers/common.d.ts" />
-
 import _ from 'lodash';
 import coreModule from 'app/core/core_module';
 import appEvents from 'app/core/app_events';
diff --git a/public/app/features/plugins/plugin_edit_ctrl.ts b/public/app/features/plugins/plugin_edit_ctrl.ts
index 37a4db82d51..07d7911df1a 100644
--- a/public/app/features/plugins/plugin_edit_ctrl.ts
+++ b/public/app/features/plugins/plugin_edit_ctrl.ts
@@ -1,5 +1,3 @@
-///<reference path="../../headers/common.d.ts" />
-
 import angular from 'angular';
 import _ from 'lodash';
 import Remarkable from 'remarkable';
@@ -35,7 +33,7 @@ export class PluginEditCtrl {
         subTitle: model.info.author.name,
         url: '',
         text: '',
-        breadcrumbs: [{ title: 'Plugins', url: '/plugins' }, { title: model.name }],
+        breadcrumbs: [{ title: 'Plugins', url: 'plugins' }, { title: model.name }],
         children: [
           {
             icon: 'fa fa-fw fa-file-text-o',
diff --git a/public/app/features/plugins/row_ctrl.ts b/public/app/features/plugins/row_ctrl.ts
index 998bd81c141..90fc0d07e38 100644
--- a/public/app/features/plugins/row_ctrl.ts
+++ b/public/app/features/plugins/row_ctrl.ts
@@ -1,5 +1,3 @@
-///<reference path="../../headers/common.d.ts" />
-
 import _ from 'lodash';
 
 export class DashboardRowCtrl {
diff --git a/public/app/features/snapshot/snapshot_ctrl.ts b/public/app/features/snapshot/snapshot_ctrl.ts
index 7969707a529..1edeafe0f6f 100644
--- a/public/app/features/snapshot/snapshot_ctrl.ts
+++ b/public/app/features/snapshot/snapshot_ctrl.ts
@@ -1,5 +1,3 @@
-///<reference path="../../headers/common.d.ts" />
-
 import angular from 'angular';
 import _ from 'lodash';
 
diff --git a/public/app/features/templating/constant_variable.ts b/public/app/features/templating/constant_variable.ts
index 5523619c347..f2fb4294537 100644
--- a/public/app/features/templating/constant_variable.ts
+++ b/public/app/features/templating/constant_variable.ts
@@ -1,5 +1,3 @@
-///<reference path="../../headers/common.d.ts" />
-
 import { Variable, assignModelProperties, variableTypes } from './variable';
 
 export class ConstantVariable implements Variable {
diff --git a/public/app/features/templating/custom_variable.ts b/public/app/features/templating/custom_variable.ts
index 12dfac43a71..c15178f6644 100644
--- a/public/app/features/templating/custom_variable.ts
+++ b/public/app/features/templating/custom_variable.ts
@@ -1,5 +1,3 @@
-///<reference path="../../headers/common.d.ts" />
-
 import _ from 'lodash';
 import { Variable, assignModelProperties, variableTypes } from './variable';
 
diff --git a/public/app/features/templating/datasource_variable.ts b/public/app/features/templating/datasource_variable.ts
index b3b35c281b3..0c5b226c372 100644
--- a/public/app/features/templating/datasource_variable.ts
+++ b/public/app/features/templating/datasource_variable.ts
@@ -1,5 +1,3 @@
-///<reference path="../../headers/common.d.ts" />
-
 import kbn from 'app/core/utils/kbn';
 import { Variable, containsVariable, assignModelProperties, variableTypes } from './variable';
 
diff --git a/public/app/features/templating/interval_variable.ts b/public/app/features/templating/interval_variable.ts
index 30583a8154b..3faac316f98 100644
--- a/public/app/features/templating/interval_variable.ts
+++ b/public/app/features/templating/interval_variable.ts
@@ -1,5 +1,3 @@
-///<reference path="../../headers/common.d.ts" />
-
 import _ from 'lodash';
 import kbn from 'app/core/utils/kbn';
 import { Variable, assignModelProperties, variableTypes } from './variable';
diff --git a/public/app/features/templating/variable_srv.ts b/public/app/features/templating/variable_srv.ts
index 217d568a34f..fb882516e85 100644
--- a/public/app/features/templating/variable_srv.ts
+++ b/public/app/features/templating/variable_srv.ts
@@ -1,5 +1,3 @@
-///<reference path="../../headers/common.d.ts" />
-
 import angular from 'angular';
 import _ from 'lodash';
 import coreModule from 'app/core/core_module';
diff --git a/public/app/headers/common.d.ts b/public/app/headers/common.d.ts
deleted file mode 100644
index a774a4d50e9..00000000000
--- a/public/app/headers/common.d.ts
+++ /dev/null
@@ -1,11 +0,0 @@
-declare var System: any;
-
-declare module 'eventemitter3' {
-  var config: any;
-  export default config;
-}
-
-declare module 'gemini-scrollbar' {
-  var d3: any;
-  export default d3;
-}
diff --git a/public/app/partials/login.html b/public/app/partials/login.html
index 29988eb8f05..54c59c04429 100644
--- a/public/app/partials/login.html
+++ b/public/app/partials/login.html
@@ -63,7 +63,7 @@
         <div class="login-signup-title p-r-1">
           New to Grafana?
         </div>
-        <a href="/signup" class="btn btn-medium btn-signup btn-p-x-2">
+        <a href="signup" class="btn btn-medium btn-signup btn-p-x-2">
           Sign Up
         </a>
       </div>
diff --git a/public/app/partials/reset_password.html b/public/app/partials/reset_password.html
index b6517a6670b..340d8f8f329 100644
--- a/public/app/partials/reset_password.html
+++ b/public/app/partials/reset_password.html
@@ -12,7 +12,7 @@
 				<button type="submit" class="btn btn-success" ng-click="sendResetEmail();" ng-disabled="!sendResetForm.$valid">
 					Reset Password
 				</button>
-				<a href="/login" class="btn btn-inverse">
+				<a href="login" class="btn btn-inverse">
 					Back
 				</a>
 
@@ -22,7 +22,7 @@
 			An email with a reset link as been sent to the email address. <br>
 			You should receive it shortly.
 			<div class="p-t-1">
-				<a href="/login" class="btn btn-success p-t-1">
+				<a href="login" class="btn btn-success p-t-1">
 					Login
 				</a>
 			</div>
diff --git a/public/app/partials/signup_step2.html b/public/app/partials/signup_step2.html
index 865c37c4c26..b01c8160b16 100644
--- a/public/app/partials/signup_step2.html
+++ b/public/app/partials/signup_step2.html
@@ -40,7 +40,7 @@
         <button type="submit" class="btn btn-success" ng-click="ctrl.submit();" ng-disabled="!signUpForm.$valid">
           Sign Up
         </button>
-        <a href="/login" class="btn btn-inverse">
+        <a href="login" class="btn btn-inverse">
             Back
         </a>
       </div>
diff --git a/public/app/plugins/app/testdata/module.ts b/public/app/plugins/app/testdata/module.ts
index cc695040d5f..812aba20464 100644
--- a/public/app/plugins/app/testdata/module.ts
+++ b/public/app/plugins/app/testdata/module.ts
@@ -1,5 +1,3 @@
-///<reference path="../../../headers/common.d.ts" />
-
 export class ConfigCtrl {
   static template = '';
 
diff --git a/public/app/plugins/datasource/cloudwatch/config_ctrl.ts b/public/app/plugins/datasource/cloudwatch/config_ctrl.ts
index f1494623266..ff0d39944ca 100644
--- a/public/app/plugins/datasource/cloudwatch/config_ctrl.ts
+++ b/public/app/plugins/datasource/cloudwatch/config_ctrl.ts
@@ -1,5 +1,3 @@
-///<reference path="../../../headers/common.d.ts" />
-
 export class CloudWatchConfigCtrl {
   static templateUrl = 'partials/config.html';
   current: any;
diff --git a/public/app/plugins/datasource/cloudwatch/query_ctrl.ts b/public/app/plugins/datasource/cloudwatch/query_ctrl.ts
index 297afbe486f..0d250935445 100644
--- a/public/app/plugins/datasource/cloudwatch/query_ctrl.ts
+++ b/public/app/plugins/datasource/cloudwatch/query_ctrl.ts
@@ -1,5 +1,3 @@
-///<reference path="../../../headers/common.d.ts" />
-
 import './query_parameter_ctrl';
 import { QueryCtrl } from 'app/plugins/sdk';
 
diff --git a/public/app/plugins/datasource/elasticsearch/datasource.ts b/public/app/plugins/datasource/elasticsearch/datasource.ts
index 62c8f176407..1c9f46867f9 100644
--- a/public/app/plugins/datasource/elasticsearch/datasource.ts
+++ b/public/app/plugins/datasource/elasticsearch/datasource.ts
@@ -1,5 +1,3 @@
-///<reference path="../../../headers/common.d.ts" />
-
 import angular from 'angular';
 import _ from 'lodash';
 import moment from 'moment';
diff --git a/public/app/plugins/datasource/elasticsearch/elastic_response.ts b/public/app/plugins/datasource/elasticsearch/elastic_response.ts
index 0c103f046da..ede5cb0ba3a 100644
--- a/public/app/plugins/datasource/elasticsearch/elastic_response.ts
+++ b/public/app/plugins/datasource/elasticsearch/elastic_response.ts
@@ -1,5 +1,3 @@
-///<reference path="../../../headers/common.d.ts" />
-
 import _ from 'lodash';
 import * as queryDef from './query_def';
 import TableModel from 'app/core/table_model';
@@ -340,7 +338,7 @@ export class ElasticResponse {
     if (err.root_cause && err.root_cause.length > 0 && err.root_cause[0].reason) {
       result.message = err.root_cause[0].reason;
     } else {
-      result.message = err.reason || 'Unkown elatic error response';
+      result.message = err.reason || 'Unkown elastic error response';
     }
 
     if (response.$$config) {
diff --git a/public/app/plugins/datasource/elasticsearch/query_ctrl.ts b/public/app/plugins/datasource/elasticsearch/query_ctrl.ts
index 450824605dd..9364d03899a 100644
--- a/public/app/plugins/datasource/elasticsearch/query_ctrl.ts
+++ b/public/app/plugins/datasource/elasticsearch/query_ctrl.ts
@@ -1,5 +1,3 @@
-///<reference path="../../../headers/common.d.ts" />
-
 import './bucket_agg';
 import './metric_agg';
 
diff --git a/public/app/plugins/datasource/elasticsearch/query_def.ts b/public/app/plugins/datasource/elasticsearch/query_def.ts
index 8e9d6e5c717..bd4f9b1817e 100644
--- a/public/app/plugins/datasource/elasticsearch/query_def.ts
+++ b/public/app/plugins/datasource/elasticsearch/query_def.ts
@@ -1,5 +1,3 @@
-///<reference path="../../../headers/common.d.ts" />
-
 import _ from 'lodash';
 
 export const metricAggTypes = [
diff --git a/public/app/plugins/datasource/grafana-live/datasource.ts b/public/app/plugins/datasource/grafana-live/datasource.ts
index dcf2ec0d21c..5cba43dd2f9 100644
--- a/public/app/plugins/datasource/grafana-live/datasource.ts
+++ b/public/app/plugins/datasource/grafana-live/datasource.ts
@@ -1,5 +1,3 @@
-///<reference path="../../../headers/common.d.ts" />
-
 import { liveSrv } from 'app/core/core';
 
 class DataObservable {
diff --git a/public/app/plugins/datasource/grafana-live/module.ts b/public/app/plugins/datasource/grafana-live/module.ts
index 81e65253efb..d75680a494b 100644
--- a/public/app/plugins/datasource/grafana-live/module.ts
+++ b/public/app/plugins/datasource/grafana-live/module.ts
@@ -1,5 +1,3 @@
-///<reference path="../../../headers/common.d.ts" />
-
 import { GrafanaStreamDS } from './datasource';
 import { QueryCtrl } from 'app/plugins/sdk';
 
diff --git a/public/app/plugins/datasource/graphite/config_ctrl.ts b/public/app/plugins/datasource/graphite/config_ctrl.ts
index daa318e1693..16a25bacbe5 100644
--- a/public/app/plugins/datasource/graphite/config_ctrl.ts
+++ b/public/app/plugins/datasource/graphite/config_ctrl.ts
@@ -1,5 +1,3 @@
-///<reference path="../../../headers/common.d.ts" />
-
 export class GraphiteConfigCtrl {
   static templateUrl = 'public/app/plugins/datasource/graphite/partials/config.html';
   datasourceSrv: any;
diff --git a/public/app/plugins/datasource/graphite/datasource.ts b/public/app/plugins/datasource/graphite/datasource.ts
index e8750999936..38133f801d8 100644
--- a/public/app/plugins/datasource/graphite/datasource.ts
+++ b/public/app/plugins/datasource/graphite/datasource.ts
@@ -1,5 +1,3 @@
-///<reference path="../../../headers/common.d.ts" />
-
 import _ from 'lodash';
 import * as dateMath from 'app/core/utils/datemath';
 import { isVersionGtOrEq, SemVersion } from 'app/core/utils/version';
diff --git a/public/app/plugins/datasource/graphite/lexer.ts b/public/app/plugins/datasource/graphite/lexer.ts
index 7c813b6b7f7..744ce2fcc3f 100644
--- a/public/app/plugins/datasource/graphite/lexer.ts
+++ b/public/app/plugins/datasource/graphite/lexer.ts
@@ -1,5 +1,3 @@
-///<reference path="../../../headers/common.d.ts" />
-
 import _ from 'lodash';
 
 // This is auto generated from the unicode tables.
diff --git a/public/app/plugins/datasource/influxdb/influx_query.ts b/public/app/plugins/datasource/influxdb/influx_query.ts
index 0e3d6312afe..656647b4413 100644
--- a/public/app/plugins/datasource/influxdb/influx_query.ts
+++ b/public/app/plugins/datasource/influxdb/influx_query.ts
@@ -1,5 +1,3 @@
-///<reference path="../../../headers/common.d.ts" />
-
 import _ from 'lodash';
 import queryPart from './query_part';
 import kbn from 'app/core/utils/kbn';
diff --git a/public/app/plugins/datasource/influxdb/query_part.ts b/public/app/plugins/datasource/influxdb/query_part.ts
index adf8855d5c6..ce5588abe53 100644
--- a/public/app/plugins/datasource/influxdb/query_part.ts
+++ b/public/app/plugins/datasource/influxdb/query_part.ts
@@ -1,5 +1,3 @@
-///<reference path="../../../headers/common.d.ts" />
-
 import _ from 'lodash';
 import { QueryPartDef, QueryPart, functionRenderer, suffixRenderer } from 'app/core/components/query_part/query_part';
 
diff --git a/public/app/plugins/datasource/mixed/datasource.ts b/public/app/plugins/datasource/mixed/datasource.ts
index 559eeb0aa6e..f12f93f14ad 100644
--- a/public/app/plugins/datasource/mixed/datasource.ts
+++ b/public/app/plugins/datasource/mixed/datasource.ts
@@ -1,5 +1,3 @@
-///<reference path="../../../headers/common.d.ts" />
-
 import angular from 'angular';
 import _ from 'lodash';
 
diff --git a/public/app/plugins/datasource/mixed/module.ts b/public/app/plugins/datasource/mixed/module.ts
index 624aefc0998..6ae72be9a45 100644
--- a/public/app/plugins/datasource/mixed/module.ts
+++ b/public/app/plugins/datasource/mixed/module.ts
@@ -1,4 +1,2 @@
-///<reference path="../../../headers/common.d.ts" />
-
 import { MixedDatasource } from './datasource';
 export { MixedDatasource, MixedDatasource as Datasource };
diff --git a/public/app/plugins/datasource/mysql/datasource.ts b/public/app/plugins/datasource/mysql/datasource.ts
index 9894cc8623c..42fcf7b4564 100644
--- a/public/app/plugins/datasource/mysql/datasource.ts
+++ b/public/app/plugins/datasource/mysql/datasource.ts
@@ -1,5 +1,3 @@
-///<reference path="../../../headers/common.d.ts" />
-
 import _ from 'lodash';
 import ResponseParser from './response_parser';
 
diff --git a/public/app/plugins/datasource/mysql/module.ts b/public/app/plugins/datasource/mysql/module.ts
index b5c56181889..bb5b5bd9056 100644
--- a/public/app/plugins/datasource/mysql/module.ts
+++ b/public/app/plugins/datasource/mysql/module.ts
@@ -1,5 +1,3 @@
-///<reference path="../../../headers/common.d.ts" />
-
 import { MysqlDatasource } from './datasource';
 import { MysqlQueryCtrl } from './query_ctrl';
 
diff --git a/public/app/plugins/datasource/mysql/query_ctrl.ts b/public/app/plugins/datasource/mysql/query_ctrl.ts
index cdc8e16a687..4961ce9e653 100644
--- a/public/app/plugins/datasource/mysql/query_ctrl.ts
+++ b/public/app/plugins/datasource/mysql/query_ctrl.ts
@@ -1,5 +1,3 @@
-///<reference path="../../../headers/common.d.ts" />
-
 import _ from 'lodash';
 import { QueryCtrl } from 'app/plugins/sdk';
 
diff --git a/public/app/plugins/datasource/mysql/response_parser.ts b/public/app/plugins/datasource/mysql/response_parser.ts
index 6689ec72b9b..3db2dfe6ac3 100644
--- a/public/app/plugins/datasource/mysql/response_parser.ts
+++ b/public/app/plugins/datasource/mysql/response_parser.ts
@@ -1,5 +1,3 @@
-///<reference path="../../../headers/common.d.ts" />
-
 import _ from 'lodash';
 
 export default class ResponseParser {
diff --git a/public/app/plugins/datasource/opentsdb/config_ctrl.ts b/public/app/plugins/datasource/opentsdb/config_ctrl.ts
index 24fc7a2a420..2276c0e4a14 100644
--- a/public/app/plugins/datasource/opentsdb/config_ctrl.ts
+++ b/public/app/plugins/datasource/opentsdb/config_ctrl.ts
@@ -1,5 +1,3 @@
-///<reference path="../../../headers/common.d.ts" />
-
 export class OpenTsConfigCtrl {
   static templateUrl = 'public/app/plugins/datasource/opentsdb/partials/config.html';
   current: any;
diff --git a/public/app/plugins/datasource/opentsdb/query_ctrl.ts b/public/app/plugins/datasource/opentsdb/query_ctrl.ts
index 628bdd9f0ce..5808571e820 100644
--- a/public/app/plugins/datasource/opentsdb/query_ctrl.ts
+++ b/public/app/plugins/datasource/opentsdb/query_ctrl.ts
@@ -1,5 +1,3 @@
-///<reference path="../../../headers/common.d.ts" />
-
 import _ from 'lodash';
 import kbn from 'app/core/utils/kbn';
 import { QueryCtrl } from 'app/plugins/sdk';
diff --git a/public/app/plugins/datasource/postgres/datasource.ts b/public/app/plugins/datasource/postgres/datasource.ts
index dd39da5d18d..8eee389d1a5 100644
--- a/public/app/plugins/datasource/postgres/datasource.ts
+++ b/public/app/plugins/datasource/postgres/datasource.ts
@@ -1,5 +1,3 @@
-///<reference path="../../../headers/common.d.ts" />
-
 import _ from 'lodash';
 import ResponseParser from './response_parser';
 
diff --git a/public/app/plugins/datasource/postgres/module.ts b/public/app/plugins/datasource/postgres/module.ts
index 2ff50dd06b9..acd23318b6d 100644
--- a/public/app/plugins/datasource/postgres/module.ts
+++ b/public/app/plugins/datasource/postgres/module.ts
@@ -1,5 +1,3 @@
-///<reference path="../../../headers/common.d.ts" />
-
 import { PostgresDatasource } from './datasource';
 import { PostgresQueryCtrl } from './query_ctrl';
 
diff --git a/public/app/plugins/datasource/postgres/query_ctrl.ts b/public/app/plugins/datasource/postgres/query_ctrl.ts
index 6f928a1755c..7afd0cf7253 100644
--- a/public/app/plugins/datasource/postgres/query_ctrl.ts
+++ b/public/app/plugins/datasource/postgres/query_ctrl.ts
@@ -1,5 +1,3 @@
-///<reference path="../../../headers/common.d.ts" />
-
 import _ from 'lodash';
 import { QueryCtrl } from 'app/plugins/sdk';
 
diff --git a/public/app/plugins/datasource/postgres/response_parser.ts b/public/app/plugins/datasource/postgres/response_parser.ts
index d78f406541a..620aba5fa7e 100644
--- a/public/app/plugins/datasource/postgres/response_parser.ts
+++ b/public/app/plugins/datasource/postgres/response_parser.ts
@@ -1,5 +1,3 @@
-///<reference path="../../../headers/common.d.ts" />
-
 import _ from 'lodash';
 
 export default class ResponseParser {
diff --git a/public/app/plugins/datasource/prometheus/completer.ts b/public/app/plugins/datasource/prometheus/completer.ts
index 32e2c4aa0f4..81c3786a932 100644
--- a/public/app/plugins/datasource/prometheus/completer.ts
+++ b/public/app/plugins/datasource/prometheus/completer.ts
@@ -1,5 +1,3 @@
-///<reference path="../../../headers/common.d.ts" />
-
 import { PrometheusDatasource } from './datasource';
 import _ from 'lodash';
 
diff --git a/public/app/plugins/panel/alertlist/module.html b/public/app/plugins/panel/alertlist/module.html
index abc35cef7fb..d25570ceed3 100644
--- a/public/app/plugins/panel/alertlist/module.html
+++ b/public/app/plugins/panel/alertlist/module.html
@@ -29,23 +29,20 @@
   <section ng-if="ctrl.panel.show === 'changes'">
     <ol class="alert-rule-list">
       <li class="alert-rule-item" ng-repeat="al in ctrl.alertHistory">
+        <div class="alert-rule-item__icon {{al.stateModel.stateClass}}">
+          <i class="{{al.stateModel.iconClass}}"></i>
+        </div>
         <div class="alert-rule-item__body">
-          <div class="alert-rule-item__icon {{al.stateModel.stateClass}}">
-            <i class="{{al.stateModel.iconClass}}"></i>
-          </div>
           <div class="alert-rule-item__header">
             <p class="alert-rule-item__name">{{al.alertName}}</p>
             <div class="alert-rule-item__text">
               <span class="{{al.stateModel.stateClass}}">{{al.stateModel.text}}</span>
             </div>
           </div>
-          <span ng-show="al.info !== 'No Data'" class="alert-rule-item__info alert-rule-item__info--left">{{al.info}}</span>
+          <span class="alert-rule-item__info">{{al.info}}</span>
         </div>
-        <div class="alert-list__footer alert-list__footer--column alert-rule-item__time">
+        <div class="alert-rule-item__time">
           <span>{{al.time}}</span>
-          <span>
-            <!--Img Link-->
-          </span>
         </div>
       </li>
     </ol>
diff --git a/public/app/plugins/panel/alertlist/module.ts b/public/app/plugins/panel/alertlist/module.ts
index 45cbcc7c0d3..35fbaead3b1 100644
--- a/public/app/plugins/panel/alertlist/module.ts
+++ b/public/app/plugins/panel/alertlist/module.ts
@@ -1,5 +1,3 @@
-///<reference path="../../../headers/common.d.ts" />
-
 import _ from 'lodash';
 import moment from 'moment';
 import alertDef from '../../../features/alerting/alert_def';
@@ -76,13 +74,19 @@ class AlertListPanel extends PanelCtrl {
   }
 
   onRefresh() {
+    let getAlertsPromise;
+
     if (this.panel.show === 'current') {
-      this.getCurrentAlertState();
+      getAlertsPromise = this.getCurrentAlertState();
     }
 
     if (this.panel.show === 'changes') {
-      this.getStateChanges();
+      getAlertsPromise = this.getStateChanges();
     }
+
+    getAlertsPromise.then(() => {
+      this.renderingCompleted();
+    });
   }
 
   getStateChanges() {
@@ -99,7 +103,7 @@ class AlertListPanel extends PanelCtrl {
     params.from = dateMath.parse(this.dashboard.time.from).unix() * 1000;
     params.to = dateMath.parse(this.dashboard.time.to).unix() * 1000;
 
-    this.backendSrv.get(`/api/annotations`, params).then(res => {
+    return this.backendSrv.get(`/api/annotations`, params).then(res => {
       this.alertHistory = _.map(res, al => {
         al.time = this.dashboard.formatDate(al.time, 'MMM D, YYYY HH:mm:ss');
         al.stateModel = alertDef.getStateDisplayModel(al.newState);
@@ -107,6 +111,8 @@ class AlertListPanel extends PanelCtrl {
         return al;
       });
       this.noAlertsMessage = this.alertHistory.length === 0 ? 'No alerts in current time range' : '';
+
+      return this.alertHistory;
     });
   }
 
@@ -119,7 +125,7 @@ class AlertListPanel extends PanelCtrl {
       params.dashboardId = this.dashboard.id;
     }
 
-    this.backendSrv.get(`/api/alerts`, params).then(res => {
+    return this.backendSrv.get(`/api/alerts`, params).then(res => {
       this.currentAlerts = this.sortResult(
         _.map(res, al => {
           al.stateModel = alertDef.getStateDisplayModel(al.state);
@@ -130,6 +136,8 @@ class AlertListPanel extends PanelCtrl {
         })
       );
       this.noAlertsMessage = this.currentAlerts.length === 0 ? 'No alerts' : '';
+
+      return this.currentAlerts;
     });
   }
 
diff --git a/public/app/plugins/panel/gettingstarted/module.ts b/public/app/plugins/panel/gettingstarted/module.ts
index 1155cb98209..cfb7016625f 100644
--- a/public/app/plugins/panel/gettingstarted/module.ts
+++ b/public/app/plugins/panel/gettingstarted/module.ts
@@ -1,5 +1,3 @@
-///<reference path="../../../headers/common.d.ts" />
-
 import { PanelCtrl } from 'app/plugins/sdk';
 
 import { contextSrv } from 'app/core/core';
diff --git a/public/app/plugins/panel/graph/axes_editor.ts b/public/app/plugins/panel/graph/axes_editor.ts
index d4aa0e8b486..cf870c18b49 100644
--- a/public/app/plugins/panel/graph/axes_editor.ts
+++ b/public/app/plugins/panel/graph/axes_editor.ts
@@ -1,5 +1,3 @@
-///<reference path="../../../headers/common.d.ts" />
-
 import kbn from 'app/core/utils/kbn';
 
 export class AxesEditorCtrl {
diff --git a/public/app/plugins/panel/graph/module.ts b/public/app/plugins/panel/graph/module.ts
index bf804180248..59e72124c74 100644
--- a/public/app/plugins/panel/graph/module.ts
+++ b/public/app/plugins/panel/graph/module.ts
@@ -1,5 +1,3 @@
-///<reference path="../../../headers/common.d.ts" />
-
 import './graph';
 import './legend';
 import './series_overrides_ctrl';
diff --git a/public/app/plugins/panel/graph/specs/graph_ctrl_specs.ts b/public/app/plugins/panel/graph/specs/graph_ctrl_specs.ts
index e3380cb86c7..d5cefb345cf 100644
--- a/public/app/plugins/panel/graph/specs/graph_ctrl_specs.ts
+++ b/public/app/plugins/panel/graph/specs/graph_ctrl_specs.ts
@@ -1,5 +1,3 @@
-///<reference path="../../../../headers/common.d.ts" />
-
 import { describe, beforeEach, it, expect, angularMocks } from '../../../../../test/lib/common';
 
 import moment from 'moment';
diff --git a/public/app/plugins/panel/graph/specs/graph_specs.ts b/public/app/plugins/panel/graph/specs/graph_specs.ts
index 29206c0f49c..176bb65b806 100644
--- a/public/app/plugins/panel/graph/specs/graph_specs.ts
+++ b/public/app/plugins/panel/graph/specs/graph_specs.ts
@@ -1,5 +1,3 @@
-///<reference path="../../../../headers/common.d.ts" />
-
 import { describe, beforeEach, it, sinon, expect, angularMocks } from '../../../../../test/lib/common';
 
 import '../module';
diff --git a/public/app/plugins/panel/graph/specs/threshold_manager_specs.ts b/public/app/plugins/panel/graph/specs/threshold_manager_specs.ts
index d4ef105190b..ec219642401 100644
--- a/public/app/plugins/panel/graph/specs/threshold_manager_specs.ts
+++ b/public/app/plugins/panel/graph/specs/threshold_manager_specs.ts
@@ -1,5 +1,3 @@
-///<reference path="../../../../headers/common.d.ts" />
-
 import { describe, it, expect } from '../../../../../test/lib/common';
 
 import { ThresholdManager } from '../threshold_manager';
diff --git a/public/app/plugins/panel/graph/specs/tooltip_specs.ts b/public/app/plugins/panel/graph/specs/tooltip_specs.ts
index 960f5fbfc80..c12697eadac 100644
--- a/public/app/plugins/panel/graph/specs/tooltip_specs.ts
+++ b/public/app/plugins/panel/graph/specs/tooltip_specs.ts
@@ -1,5 +1,3 @@
-///<reference path="../../../../headers/common.d.ts" />
-
 import { describe, beforeEach, it, sinon, expect } from '../../../../../test/lib/common';
 
 import $ from 'jquery';
diff --git a/public/app/plugins/panel/graph/thresholds_form.ts b/public/app/plugins/panel/graph/thresholds_form.ts
index bd6911bd4e3..48b2112e4bc 100644
--- a/public/app/plugins/panel/graph/thresholds_form.ts
+++ b/public/app/plugins/panel/graph/thresholds_form.ts
@@ -1,5 +1,3 @@
-///<reference path="../../../headers/common.d.ts" />
-
 import coreModule from 'app/core/core_module';
 
 export class ThresholdFormCtrl {
diff --git a/public/app/plugins/panel/heatmap/axes_editor.ts b/public/app/plugins/panel/heatmap/axes_editor.ts
index ed213b31acb..05ed63e0289 100644
--- a/public/app/plugins/panel/heatmap/axes_editor.ts
+++ b/public/app/plugins/panel/heatmap/axes_editor.ts
@@ -1,5 +1,3 @@
-///<reference path="../../../headers/common.d.ts" />
-
 import kbn from 'app/core/utils/kbn';
 
 export class AxesEditorCtrl {
diff --git a/public/app/plugins/panel/heatmap/display_editor.ts b/public/app/plugins/panel/heatmap/display_editor.ts
index 775017b00da..b30c77a1733 100644
--- a/public/app/plugins/panel/heatmap/display_editor.ts
+++ b/public/app/plugins/panel/heatmap/display_editor.ts
@@ -1,5 +1,3 @@
-///<reference path="../../../headers/common.d.ts" />
-
 export class HeatmapDisplayEditorCtrl {
   panel: any;
   panelCtrl: any;
diff --git a/public/app/plugins/panel/heatmap/specs/heatmap_ctrl_specs.ts b/public/app/plugins/panel/heatmap/specs/heatmap_ctrl_specs.ts
index af076836a18..98055ccf52d 100644
--- a/public/app/plugins/panel/heatmap/specs/heatmap_ctrl_specs.ts
+++ b/public/app/plugins/panel/heatmap/specs/heatmap_ctrl_specs.ts
@@ -1,5 +1,3 @@
-///<reference path="../../../../headers/common.d.ts" />
-
 import { describe, beforeEach, it, expect, angularMocks } from '../../../../../test/lib/common';
 
 import moment from 'moment';
diff --git a/public/app/plugins/panel/heatmap/specs/renderer_specs.ts b/public/app/plugins/panel/heatmap/specs/renderer_specs.ts
index 29c5398a03b..6c1a94c96eb 100644
--- a/public/app/plugins/panel/heatmap/specs/renderer_specs.ts
+++ b/public/app/plugins/panel/heatmap/specs/renderer_specs.ts
@@ -1,5 +1,3 @@
-///<reference path="../../../../headers/common.d.ts" />
-
 import { describe, beforeEach, it, sinon, expect, angularMocks } from '../../../../../test/lib/common';
 
 import '../module';
diff --git a/public/app/plugins/panel/table/column_options.ts b/public/app/plugins/panel/table/column_options.ts
index 04b27c610d2..9facfbeac9c 100644
--- a/public/app/plugins/panel/table/column_options.ts
+++ b/public/app/plugins/panel/table/column_options.ts
@@ -1,5 +1,3 @@
-///<reference path="../../../headers/common.d.ts" />
-
 import _ from 'lodash';
 import kbn from 'app/core/utils/kbn';
 
diff --git a/public/app/plugins/panel/table/editor.ts b/public/app/plugins/panel/table/editor.ts
index 027bf6cc918..7358f10bca0 100644
--- a/public/app/plugins/panel/table/editor.ts
+++ b/public/app/plugins/panel/table/editor.ts
@@ -1,5 +1,3 @@
-///<reference path="../../../headers/common.d.ts" />
-
 import _ from 'lodash';
 import { transformers } from './transformers';
 
diff --git a/public/app/plugins/panel/table/module.ts b/public/app/plugins/panel/table/module.ts
index 46f3088bcd8..27eab205f09 100644
--- a/public/app/plugins/panel/table/module.ts
+++ b/public/app/plugins/panel/table/module.ts
@@ -1,5 +1,3 @@
-///<reference path="../../../headers/common.d.ts" />
-
 import _ from 'lodash';
 import $ from 'jquery';
 import { MetricsPanelCtrl } from 'app/plugins/sdk';
diff --git a/public/app/plugins/panel/text/module.ts b/public/app/plugins/panel/text/module.ts
index ffdeb82546d..c7e75678c16 100644
--- a/public/app/plugins/panel/text/module.ts
+++ b/public/app/plugins/panel/text/module.ts
@@ -1,7 +1,6 @@
-///<reference path="../../../headers/common.d.ts" />
-
 import _ from 'lodash';
 import { PanelCtrl } from 'app/plugins/sdk';
+import Remarkable from 'remarkable';
 
 export class TextPanelCtrl extends PanelCtrl {
   static templateUrl = `public/app/plugins/panel/text/module.html`;
@@ -66,11 +65,9 @@ export class TextPanelCtrl extends PanelCtrl {
 
   renderMarkdown(content) {
     if (!this.remarkable) {
-      return System.import('remarkable').then(Remarkable => {
-        this.remarkable = new Remarkable();
-        this.$scope.$apply(() => {
-          this.updateContent(this.remarkable.render(content));
-        });
+      this.remarkable = new Remarkable();
+      this.$scope.$apply(() => {
+        this.updateContent(this.remarkable.render(content));
       });
     }
 
diff --git a/public/img/CopyQuery.png b/public/img/CopyQuery.png
deleted file mode 100644
index a923bf43603..00000000000
Binary files a/public/img/CopyQuery.png and /dev/null differ
diff --git a/public/img/tgr288gear_line6.pdf b/public/img/tgr288gear_line6.pdf
deleted file mode 100644
index 21cc75e1e33..00000000000
Binary files a/public/img/tgr288gear_line6.pdf and /dev/null differ
diff --git a/public/sass/_grafana.scss b/public/sass/_grafana.scss
index 3232e9c7f8e..06b3a374e34 100644
--- a/public/sass/_grafana.scss
+++ b/public/sass/_grafana.scss
@@ -1,104 +1,105 @@
 // vendor
-@import "../vendor/css/timepicker.css";
-@import "../vendor/css/spectrum.css";
+@import '../vendor/css/timepicker.css';
+@import '../vendor/css/spectrum.css';
 
 // MIXINS
-@import "mixins/mixins";
-@import "mixins/animations";
-@import "mixins/buttons";
-@import "mixins/breakpoints";
-@import "mixins/grid";
-@import "mixins/grid-framework";
-@import "mixins/hover";
-@import "mixins/forms";
-@import "mixins/drop_element";
+@import 'mixins/mixins';
+@import 'mixins/animations';
+@import 'mixins/buttons';
+@import 'mixins/breakpoints';
+@import 'mixins/grid';
+@import 'mixins/grid-framework';
+@import 'mixins/hover';
+@import 'mixins/forms';
+@import 'mixins/drop_element';
 
 // BASE
-@import "base/normalize";
-@import "base/reboot";
-@import "base/type";
-@import "base/forms";
-@import "base/grid";
-@import "base/fonts";
-@import "base/code";
-@import "base/icons";
+@import 'base/normalize';
+@import 'base/reboot';
+@import 'base/type';
+@import 'base/forms';
+@import 'base/grid';
+@import 'base/fonts';
+@import 'base/code';
+@import 'base/icons';
 
 // UTILS
-@import "utils/utils";
-@import "utils/validation";
-@import "utils/angular";
-@import "utils/spacings";
-@import "utils/widths";
+@import 'utils/utils';
+@import 'utils/validation';
+@import 'utils/angular';
+@import 'utils/spacings';
+@import 'utils/widths';
 
 // LAYOUTS
-@import "layout/lists";
-@import "layout/page";
+@import 'layout/lists';
+@import 'layout/page';
 
 // COMPONENTS
-@import "components/scrollbar";
-@import "components/cards";
-@import "components/buttons";
-@import "components/navs";
-@import "components/tabs";
-@import "components/alerts";
-@import "components/switch";
-@import "components/tooltip";
-@import "components/tags";
-@import "components/panel_graph";
-@import "components/submenu";
-@import "components/panel_alertlist";
-@import "components/panel_dashlist";
-@import "components/panel_gettingstarted";
-@import "components/panel_pluginlist";
-@import "components/panel_singlestat";
-@import "components/panel_table";
-@import "components/panel_text";
-@import "components/panel_heatmap";
-@import "components/panel_add_panel";
-@import "components/settings_permissions";
-@import "components/tagsinput";
-@import "components/tables_lists";
-@import "components/search";
-@import "components/gf-form";
-@import "components/sidemenu";
-@import "components/navbar";
-@import "components/timepicker";
-@import "components/filter-controls";
-@import "components/filter-list";
-@import "components/filter-table";
-@import "components/old_stuff";
-@import "components/typeahead";
-@import "components/modals";
-@import "components/dropdown";
-@import "components/color_picker";
-@import "components/footer";
-@import "components/infobox";
-@import "components/shortcuts";
-@import "components/drop";
-@import "components/query_editor";
-@import "components/tabbed_view";
-@import "components/query_part";
-@import "components/jsontree";
-@import "components/edit_sidemenu";
-@import "components/row.scss";
-@import "components/json_explorer";
-@import "components/code_editor";
-@import "components/dashboard_grid";
-@import "components/dashboard_list";
-@import "components/page_header";
-@import "components/dashboard_settings";
-@import "components/empty_list_cta";
+@import 'components/scrollbar';
+@import 'components/cards';
+@import 'components/buttons';
+@import 'components/navs';
+@import 'components/tabs';
+@import 'components/alerts';
+@import 'components/switch';
+@import 'components/tooltip';
+@import 'components/tags';
+@import 'components/panel_graph';
+@import 'components/submenu';
+@import 'components/panel_alertlist';
+@import 'components/panel_dashlist';
+@import 'components/panel_gettingstarted';
+@import 'components/panel_pluginlist';
+@import 'components/panel_singlestat';
+@import 'components/panel_table';
+@import 'components/panel_text';
+@import 'components/panel_heatmap';
+@import 'components/panel_add_panel';
+@import 'components/settings_permissions';
+@import 'components/tagsinput';
+@import 'components/tables_lists';
+@import 'components/search';
+@import 'components/gf-form';
+@import 'components/sidemenu';
+@import 'components/navbar';
+@import 'components/timepicker';
+@import 'components/filter-controls';
+@import 'components/filter-list';
+@import 'components/filter-table';
+@import 'components/old_stuff';
+@import 'components/typeahead';
+@import 'components/modals';
+@import 'components/dropdown';
+@import 'components/color_picker';
+@import 'components/footer';
+@import 'components/infobox';
+@import 'components/shortcuts';
+@import 'components/drop';
+@import 'components/query_editor';
+@import 'components/tabbed_view';
+@import 'components/query_part';
+@import 'components/jsontree';
+@import 'components/edit_sidemenu';
+@import 'components/row.scss';
+@import 'components/json_explorer';
+@import 'components/code_editor';
+@import 'components/dashboard_grid';
+@import 'components/dashboard_list';
+@import 'components/page_header';
+@import 'components/dashboard_settings';
+@import 'components/empty_list_cta';
+@import 'components/popper';
 
 // PAGES
-@import "pages/login";
-@import "pages/dashboard";
-@import "pages/playlist";
-@import "pages/admin";
-@import "pages/alerting";
-@import "pages/history";
-@import "pages/plugins";
-@import "pages/signup";
-@import "pages/styleguide";
-@import "pages/errorpage";
-@import "old_responsive";
-@import "components/view_states.scss";
+@import 'pages/login';
+@import 'pages/dashboard';
+@import 'pages/playlist';
+@import 'pages/admin';
+@import 'pages/alerting';
+@import 'pages/history';
+@import 'pages/plugins';
+@import 'pages/signup';
+@import 'pages/styleguide';
+@import 'pages/errorpage';
+@import 'old_responsive';
+@import 'components/view_states.scss';
diff --git a/public/sass/base/_type.scss b/public/sass/base/_type.scss
index aeddbc5ffb7..b69f7a0b439 100644
--- a/public/sass/base/_type.scss
+++ b/public/sass/base/_type.scss
@@ -299,7 +299,7 @@ blockquote {
     line-height: $line-height-base;
     color: $gray-2;
     &:before {
-      content: "\2014 \00A0";
+      content: '\2014 \00A0';
     }
   }
 
@@ -316,10 +316,10 @@ blockquote {
     }
     small {
       &:before {
-        content: "";
+        content: '';
       }
       &:after {
-        content: "\00A0 \2014";
+        content: '\00A0 \2014';
       }
     }
   }
@@ -330,7 +330,7 @@ q:before,
 q:after,
 blockquote:before,
 blockquote:after {
-  content: "";
+  content: '';
 }
 
 // Addresses
@@ -409,3 +409,8 @@ a.external-link {
 .no-wrap {
   white-space: nowrap;
 }
+
+.highlight-search-match {
+  background: transparent;
+  color: $yellow;
+}
diff --git a/public/sass/components/_gf-form.scss b/public/sass/components/_gf-form.scss
index 46c68a692fa..599a3e32a21 100644
--- a/public/sass/components/_gf-form.scss
+++ b/public/sass/components/_gf-form.scss
@@ -33,6 +33,7 @@ $input-border: 1px solid $input-border-color;
 
 .gf-form--has-input-icon {
   position: relative;
+  margin-right: $gf-form-margin;
 
   .gf-form-input-icon {
     position: absolute;
diff --git a/public/sass/components/_panel_add_panel.scss b/public/sass/components/_panel_add_panel.scss
index 548d677ef47..51754a54d92 100644
--- a/public/sass/components/_panel_add_panel.scss
+++ b/public/sass/components/_panel_add_panel.scss
@@ -7,12 +7,20 @@
   display: flex;
   align-items: center;
 
-  i {
+  .gicon {
     font-size: 30px;
     margin-right: $spacer;
   }
 }
 
+.add-panel__close {
+  margin-left: auto;
+  background-color: transparent;
+  border: 0;
+  font-size: 16px;
+  margin-right: -10px;
+}
+
 .add-panel__title {
   font-size: $font-size-md;
   margin-right: $spacer/2;
diff --git a/public/sass/components/_popper.scss b/public/sass/components/_popper.scss
new file mode 100644
index 00000000000..a4809535feb
--- /dev/null
+++ b/public/sass/components/_popper.scss
@@ -0,0 +1,79 @@
+﻿.popper {
+  position: absolute;
+  background: $tooltipBackground;
+  color: $tooltipColor;
+  width: 150px;
+  border-radius: 3px;
+  box-shadow: 0 0 2px rgba(0, 0, 0, 0.5);
+  padding: 10px;
+  text-align: center;
+}
+.popper .popper__arrow {
+  width: 0;
+  height: 0;
+  border-style: solid;
+  position: absolute;
+  margin: 5px;
+}
+
+.popper .popper__arrow {
+  border-color: $tooltipBackground;
+}
+
+.popper[data-placement^='top'] {
+  margin-bottom: 5px;
+}
+.popper[data-placement^='top'] .popper__arrow {
+  border-width: 5px 5px 0 5px;
+  border-left-color: transparent;
+  border-right-color: transparent;
+  border-bottom-color: transparent;
+  bottom: -5px;
+  left: calc(50% - 5px);
+  margin-top: 0;
+  margin-bottom: 0;
+}
+.popper[data-placement^='bottom'] {
+  margin-top: 5px;
+}
+.popper[data-placement^='bottom'] .popper__arrow {
+  border-width: 0 5px 5px 5px;
+  border-left-color: transparent;
+  border-right-color: transparent;
+  border-top-color: transparent;
+  top: -5px;
+  left: calc(50% - 5px);
+  margin-top: 0;
+  margin-bottom: 0;
+}
+.popper[data-placement^='right'] {
+  margin-left: 5px;
+}
+.popper[data-placement^='right'] .popper__arrow {
+  border-width: 5px 5px 5px 0;
+  border-left-color: transparent;
+  border-top-color: transparent;
+  border-bottom-color: transparent;
+  left: -5px;
+  top: calc(50% - 5px);
+  margin-left: 0;
+  margin-right: 0;
+}
+.popper[data-placement^='left'] {
+  margin-right: 5px;
+}
+.popper[data-placement^='left'] .popper__arrow {
+  border-width: 5px 0 5px 5px;
+  border-top-color: transparent;
+  border-right-color: transparent;
+  border-bottom-color: transparent;
+  right: -5px;
+  top: calc(50% - 5px);
+  margin-left: 0;
+  margin-right: 0;
+}
+
+.popper__target,
+.popper__manager {
+  display: inline-block;
+}
diff --git a/public/sass/pages/_alerting.scss b/public/sass/pages/_alerting.scss
index 052425b11ae..f44e26d5c20 100644
--- a/public/sass/pages/_alerting.scss
+++ b/public/sass/pages/_alerting.scss
@@ -87,7 +87,6 @@
 
 .alert-rule-item {
   display: flex;
-  justify-content: space-between;
   width: 100%;
   height: 100%;
   background: $card-background;
@@ -99,16 +98,17 @@
 
 .alert-rule-item__body {
   display: flex;
-  width: 100%;
-  //flex-grow: 2;
+  flex-direction: column;
+  flex-grow: 1;
+  overflow: hidden;
 }
 
 .alert-rule-item__icon {
-  font-weight: bold;
   display: flex;
   justify-content: center;
   align-items: center;
   width: 40px;
+  padding: 0 28px 0 16px;
   .icon-gf,
   .fa {
     font-size: 200%;
@@ -118,17 +118,15 @@
 }
 
 .alert-rule-item__header {
-  padding: 0 20px;
   display: flex;
   flex-direction: column;
   justify-content: space-between;
-  //width: 100%;
 }
 
 .alert-rule-item__name {
   font-size: $font-size-base;
   margin: 0;
-  font-weight: 600;
+  font-weight: $font-weight-semi-bold;
 }
 
 .alert-list__btn {
@@ -147,6 +145,7 @@
 .alert-rule-item__time {
   color: $text-color-weak;
   font-weight: normal;
+  white-space: nowrap;
 }
 
 .alert-rule-item__info {
@@ -155,24 +154,13 @@
   flex-grow: 2;
   display: flex;
   align-items: flex-end;
-  padding-left: 20px;
 }
 
-.alert-rule-item__footer {
+.alert-rule-item__actions {
   display: flex;
   align-items: center;
 }
 
-.alert-list__footer--column {
-  flex-direction: column;
-}
-
 .alert-tesint {
   display: flex;
 }
-
-.textHighlight {
-  background: $orange;
-  color: $white;
-  padding: 0;
-}
diff --git a/vendor/github.com/go-stack/stack/.travis.yml b/vendor/github.com/go-stack/stack/.travis.yml
deleted file mode 100644
index d5e5dd52da0..00000000000
--- a/vendor/github.com/go-stack/stack/.travis.yml
+++ /dev/null
@@ -1,16 +0,0 @@
-language: go
-sudo: false
-go:
-  - 1.2
-  - 1.3
-  - 1.4
-  - 1.5
-  - 1.6
-  - tip
-
-before_install:
-  - go get github.com/mattn/goveralls
-  - go get golang.org/x/tools/cmd/cover
-
-script:
-  - goveralls -service=travis-ci
diff --git a/vendor/github.com/go-stack/stack/LICENSE.md b/vendor/github.com/go-stack/stack/LICENSE.md
index c8ca66c5ede..2abf98ea835 100644
--- a/vendor/github.com/go-stack/stack/LICENSE.md
+++ b/vendor/github.com/go-stack/stack/LICENSE.md
@@ -1,13 +1,21 @@
-Copyright 2014 Chris Hines
+The MIT License (MIT)
 
-Licensed under the Apache License, Version 2.0 (the "License");
-you may not use this file except in compliance with the License.
-You may obtain a copy of the License at
+Copyright (c) 2014 Chris Hines
 
-   http://www.apache.org/licenses/LICENSE-2.0
+Permission is hereby granted, free of charge, to any person obtaining a copy
+of this software and associated documentation files (the "Software"), to deal
+in the Software without restriction, including without limitation the rights
+to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
+copies of the Software, and to permit persons to whom the Software is
+furnished to do so, subject to the following conditions:
 
-Unless required by applicable law or agreed to in writing, software
-distributed under the License is distributed on an "AS IS" BASIS,
-WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
-See the License for the specific language governing permissions and
-limitations under the License.
+The above copyright notice and this permission notice shall be included in all
+copies or substantial portions of the Software.
+
+THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
+IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
+FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
+AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
+LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
+OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
+SOFTWARE.
diff --git a/vendor/github.com/go-stack/stack/stack.go b/vendor/github.com/go-stack/stack/stack.go
index a614eeebf16..1bc6971d889 100644
--- a/vendor/github.com/go-stack/stack/stack.go
+++ b/vendor/github.com/go-stack/stack/stack.go
@@ -1,3 +1,5 @@
+// +build go1.7
+
 // Package stack implements utilities to capture, manipulate, and format call
 // stacks. It provides a simpler API than package runtime.
 //
@@ -21,29 +23,31 @@ import (
 
 // Call records a single function invocation from a goroutine stack.
 type Call struct {
-	fn *runtime.Func
-	pc uintptr
+	frame runtime.Frame
 }
 
 // Caller returns a Call from the stack of the current goroutine. The argument
 // skip is the number of stack frames to ascend, with 0 identifying the
 // calling function.
 func Caller(skip int) Call {
-	var pcs [2]uintptr
+	// As of Go 1.9 we need room for up to three PC entries.
+	//
+	// 0. An entry for the stack frame prior to the target to check for
+	//    special handling needed if that prior entry is runtime.sigpanic.
+	// 1. A possible second entry to hold metadata about skipped inlined
+	//    functions. If inline functions were not skipped the target frame
+	//    PC will be here.
+	// 2. A third entry for the target frame PC when the second entry
+	//    is used for skipped inline functions.
+	var pcs [3]uintptr
 	n := runtime.Callers(skip+1, pcs[:])
+	frames := runtime.CallersFrames(pcs[:n])
+	frame, _ := frames.Next()
+	frame, _ = frames.Next()
 
-	var c Call
-
-	if n < 2 {
-		return c
-	}
-
-	c.pc = pcs[1]
-	if runtime.FuncForPC(pcs[0]) != sigpanic {
-		c.pc--
+	return Call{
+		frame: frame,
 	}
-	c.fn = runtime.FuncForPC(c.pc)
-	return c
 }
 
 // String implements fmt.Stinger. It is equivalent to fmt.Sprintf("%v", c).
@@ -54,9 +58,10 @@ func (c Call) String() string {
 // MarshalText implements encoding.TextMarshaler. It formats the Call the same
 // as fmt.Sprintf("%v", c).
 func (c Call) MarshalText() ([]byte, error) {
-	if c.fn == nil {
+	if c.frame == (runtime.Frame{}) {
 		return nil, ErrNoFunc
 	}
+
 	buf := bytes.Buffer{}
 	fmt.Fprint(&buf, c)
 	return buf.Bytes(), nil
@@ -71,6 +76,7 @@ var ErrNoFunc = errors.New("no call stack information")
 //    %s    source file
 //    %d    line number
 //    %n    function name
+//    %k    last segment of the package path
 //    %v    equivalent to %s:%d
 //
 // It accepts the '+' and '#' flags for most of the verbs as follows.
@@ -78,22 +84,23 @@ var ErrNoFunc = errors.New("no call stack information")
 //    %+s   path of source file relative to the compile time GOPATH
 //    %#s   full path of source file
 //    %+n   import path qualified function name
+//    %+k   full package path
 //    %+v   equivalent to %+s:%d
 //    %#v   equivalent to %#s:%d
 func (c Call) Format(s fmt.State, verb rune) {
-	if c.fn == nil {
+	if c.frame == (runtime.Frame{}) {
 		fmt.Fprintf(s, "%%!%c(NOFUNC)", verb)
 		return
 	}
 
 	switch verb {
 	case 's', 'v':
-		file, line := c.fn.FileLine(c.pc)
+		file := c.frame.File
 		switch {
 		case s.Flag('#'):
 			// done
 		case s.Flag('+'):
-			file = file[pkgIndex(file, c.fn.Name()):]
+			file = file[pkgIndex(file, c.frame.Function):]
 		default:
 			const sep = "/"
 			if i := strings.LastIndex(file, sep); i != -1 {
@@ -103,16 +110,31 @@ func (c Call) Format(s fmt.State, verb rune) {
 		io.WriteString(s, file)
 		if verb == 'v' {
 			buf := [7]byte{':'}
-			s.Write(strconv.AppendInt(buf[:1], int64(line), 10))
+			s.Write(strconv.AppendInt(buf[:1], int64(c.frame.Line), 10))
 		}
 
 	case 'd':
-		_, line := c.fn.FileLine(c.pc)
 		buf := [6]byte{}
-		s.Write(strconv.AppendInt(buf[:0], int64(line), 10))
+		s.Write(strconv.AppendInt(buf[:0], int64(c.frame.Line), 10))
+
+	case 'k':
+		name := c.frame.Function
+		const pathSep = "/"
+		start, end := 0, len(name)
+		if i := strings.LastIndex(name, pathSep); i != -1 {
+			start = i + len(pathSep)
+		}
+		const pkgSep = "."
+		if i := strings.Index(name[start:], pkgSep); i != -1 {
+			end = start + i
+		}
+		if s.Flag('+') {
+			start = 0
+		}
+		io.WriteString(s, name[start:end])
 
 	case 'n':
-		name := c.fn.Name()
+		name := c.frame.Function
 		if !s.Flag('+') {
 			const pathSep = "/"
 			if i := strings.LastIndex(name, pathSep); i != -1 {
@@ -127,35 +149,17 @@ func (c Call) Format(s fmt.State, verb rune) {
 	}
 }
 
+// Frame returns the call frame infomation for the Call.
+func (c Call) Frame() runtime.Frame {
+	return c.frame
+}
+
 // PC returns the program counter for this call frame; multiple frames may
 // have the same PC value.
+//
+// Deprecated: Use Call.Frame instead.
 func (c Call) PC() uintptr {
-	return c.pc
-}
-
-// name returns the import path qualified name of the function containing the
-// call.
-func (c Call) name() string {
-	if c.fn == nil {
-		return "???"
-	}
-	return c.fn.Name()
-}
-
-func (c Call) file() string {
-	if c.fn == nil {
-		return "???"
-	}
-	file, _ := c.fn.FileLine(c.pc)
-	return file
-}
-
-func (c Call) line() int {
-	if c.fn == nil {
-		return 0
-	}
-	_, line := c.fn.FileLine(c.pc)
-	return line
+	return c.frame.PC
 }
 
 // CallStack records a sequence of function invocations from a goroutine
@@ -179,9 +183,6 @@ func (cs CallStack) MarshalText() ([]byte, error) {
 	buf := bytes.Buffer{}
 	buf.Write(openBracketBytes)
 	for i, pc := range cs {
-		if pc.fn == nil {
-			return nil, ErrNoFunc
-		}
 		if i > 0 {
 			buf.Write(spaceBytes)
 		}
@@ -205,49 +206,22 @@ func (cs CallStack) Format(s fmt.State, verb rune) {
 	s.Write(closeBracketBytes)
 }
 
-// findSigpanic intentionally executes faulting code to generate a stack trace
-// containing an entry for runtime.sigpanic.
-func findSigpanic() *runtime.Func {
-	var fn *runtime.Func
-	var p *int
-	func() int {
-		defer func() {
-			if p := recover(); p != nil {
-				var pcs [512]uintptr
-				n := runtime.Callers(2, pcs[:])
-				for _, pc := range pcs[:n] {
-					f := runtime.FuncForPC(pc)
-					if f.Name() == "runtime.sigpanic" {
-						fn = f
-						break
-					}
-				}
-			}
-		}()
-		// intentional nil pointer dereference to trigger sigpanic
-		return *p
-	}()
-	return fn
-}
-
-var sigpanic = findSigpanic()
-
 // Trace returns a CallStack for the current goroutine with element 0
 // identifying the calling function.
 func Trace() CallStack {
 	var pcs [512]uintptr
-	n := runtime.Callers(2, pcs[:])
-	cs := make([]Call, n)
+	n := runtime.Callers(1, pcs[:])
 
-	for i, pc := range pcs[:n] {
-		pcFix := pc
-		if i > 0 && cs[i-1].fn != sigpanic {
-			pcFix--
-		}
-		cs[i] = Call{
-			fn: runtime.FuncForPC(pcFix),
-			pc: pcFix,
-		}
+	frames := runtime.CallersFrames(pcs[:n])
+	cs := make(CallStack, 0, n)
+
+	// Skip extra frame retrieved just to make sure the runtime.sigpanic
+	// special case is handled.
+	frame, more := frames.Next()
+
+	for more {
+		frame, more = frames.Next()
+		cs = append(cs, Call{frame: frame})
 	}
 
 	return cs
@@ -256,7 +230,7 @@ func Trace() CallStack {
 // TrimBelow returns a slice of the CallStack with all entries below c
 // removed.
 func (cs CallStack) TrimBelow(c Call) CallStack {
-	for len(cs) > 0 && cs[0].pc != c.pc {
+	for len(cs) > 0 && cs[0] != c {
 		cs = cs[1:]
 	}
 	return cs
@@ -265,7 +239,7 @@ func (cs CallStack) TrimBelow(c Call) CallStack {
 // TrimAbove returns a slice of the CallStack with all entries above c
 // removed.
 func (cs CallStack) TrimAbove(c Call) CallStack {
-	for len(cs) > 0 && cs[len(cs)-1].pc != c.pc {
+	for len(cs) > 0 && cs[len(cs)-1] != c {
 		cs = cs[:len(cs)-1]
 	}
 	return cs
@@ -314,12 +288,13 @@ func pkgIndex(file, funcName string) int {
 var runtimePath string
 
 func init() {
-	var pcs [1]uintptr
+	var pcs [3]uintptr
 	runtime.Callers(0, pcs[:])
-	fn := runtime.FuncForPC(pcs[0])
-	file, _ := fn.FileLine(pcs[0])
+	frames := runtime.CallersFrames(pcs[:])
+	frame, _ := frames.Next()
+	file := frame.File
 
-	idx := pkgIndex(file, fn.Name())
+	idx := pkgIndex(frame.File, frame.Function)
 
 	runtimePath = file[:idx]
 	if runtime.GOOS == "windows" {
@@ -328,7 +303,7 @@ func init() {
 }
 
 func inGoroot(c Call) bool {
-	file := c.file()
+	file := c.frame.File
 	if len(file) == 0 || file[0] == '?' {
 		return true
 	}
diff --git a/vendor/vendor.json b/vendor/vendor.json
index 2fb3bcc2f8d..09a7dc904f1 100644
--- a/vendor/vendor.json
+++ b/vendor/vendor.json
@@ -414,6 +414,14 @@
 			"revision": "9dee4ca50b83acdf57a35fb9e6fb4be640afa2f3",
 			"revisionTime": "2017-03-27T11:30:21Z"
 		},
+		{
+			"checksumSHA1": "luu+ud4XYZhlCoNnSAwCJlbh0Bg=",
+			"path": "github.com/go-stack/stack",
+			"revision": "259ab82a6cad3992b4e21ff5cac294ccb06474bc",
+			"revisionTime": "2017-11-12T03:14:02Z",
+			"version": "v1.7.0",
+			"versionExact": "v1.7.0"
+		},
 		{
 			"checksumSHA1": "HHB+Jna1wv0cXLxtCyOnQqFwvn4=",
 			"path": "github.com/go-xorm/builder",
@@ -486,7 +494,6 @@
 		},
 		{
 			"checksumSHA1": "y/A5iuvwjytQE2CqVuphQRXR2nI=",
-			"origin": "github.com/grafana/grafana/vendor/github.com/mattn/go-isatty",
 			"path": "github.com/mattn/go-isatty",
 			"revision": "a5cdd64afdee435007ee3e9f6ed4684af949d568",
 			"revisionTime": "2017-09-25T05:49:04Z"
diff --git a/yarn.lock b/yarn.lock
index 0707f7ce352..aa477878e4d 100644
--- a/yarn.lock
+++ b/yarn.lock
@@ -7508,6 +7508,10 @@ pn@^1.0.0:
   version "1.0.0"
   resolved "https://registry.yarnpkg.com/pn/-/pn-1.0.0.tgz#1cf5a30b0d806cd18f88fc41a6b5d4ad615b3ba9"
 
+popper.js@^1.12.5:
+  version "1.12.9"
+  resolved "https://registry.yarnpkg.com/popper.js/-/popper.js-1.12.9.tgz#0dfbc2dff96c451bb332edcfcfaaf566d331d5b3"
+
 posix-character-classes@^0.1.0:
   version "0.1.1"
   resolved "https://registry.yarnpkg.com/posix-character-classes/-/posix-character-classes-0.1.1.tgz#01eac0fe3b5af71a2a6c02feabb8c1fef7e00eab"
@@ -8127,6 +8131,13 @@ react-grid-layout@^0.16.1:
     react-draggable "^3.0.3"
     react-resizable "^1.7.5"
 
+react-popper@^0.7.5:
+  version "0.7.5"
+  resolved "https://registry.yarnpkg.com/react-popper/-/react-popper-0.7.5.tgz#71c25946f291db381231281f6b95729e8b801596"
+  dependencies:
+    popper.js "^1.12.5"
+    prop-types "^15.5.10"
+
 react-highlight-words@^0.10.0:
   version "0.10.0"
   resolved "https://registry.yarnpkg.com/react-highlight-words/-/react-highlight-words-0.10.0.tgz#2e905c76c11635237f848ecad00600f1b6f6f4a8"
